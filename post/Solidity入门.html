<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Solidityå­¦ä¹ ç¬”è®°(ä¸€) | æµ©çƒ¬çš„åšå®¢</title><meta name="keywords" content="Solidity"><meta name="author" content="æµ©çƒ¬"><meta name="copyright" content="æµ©çƒ¬"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Solidityå…¥é—¨å­¦ä¹ é“¾æ¥ï¼šhttps:&#x2F;&#x2F;wtf.academy&#x2F;solidity-start&#x2F; 1.HelloWeb3ç¬¬ä¸€ä¸ªSolidityç¨‹åºå¾ˆç®€å•ï¼Œåªæœ‰1è¡Œæ³¨é‡Š+3è¡Œä»£ç ï¼š 12345&#x2F;&#x2F; SPDX-License-Identifier: MITpragma solidity ^0.8.4;contract HelloWeb3&amp;#123;    string public _string">
<meta property="og:type" content="article">
<meta property="og:title" content="Solidityå­¦ä¹ ç¬”è®°(ä¸€)">
<meta property="og:url" content="https://destinywei.github.io/post/Solidity%E5%85%A5%E9%97%A8.html">
<meta property="og:site_name" content="æµ©çƒ¬çš„åšå®¢">
<meta property="og:description" content="Solidityå…¥é—¨å­¦ä¹ é“¾æ¥ï¼šhttps:&#x2F;&#x2F;wtf.academy&#x2F;solidity-start&#x2F; 1.HelloWeb3ç¬¬ä¸€ä¸ªSolidityç¨‹åºå¾ˆç®€å•ï¼Œåªæœ‰1è¡Œæ³¨é‡Š+3è¡Œä»£ç ï¼š 12345&#x2F;&#x2F; SPDX-License-Identifier: MITpragma solidity ^0.8.4;contract HelloWeb3&amp;#123;    string public _string">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg">
<meta property="article:published_time" content="2023-04-10T11:17:41.353Z">
<meta property="article:modified_time" content="2023-04-10T11:21:06.354Z">
<meta property="article:author" content="æµ©çƒ¬">
<meta property="article:tag" content="Solidity">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg"><link rel="shortcut icon" href="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/å¤´åƒ3.jpg"><link rel="canonical" href="https://destinywei.github.io/post/Solidity%E5%85%A5%E9%97%A8"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Solidityå­¦ä¹ ç¬”è®°(ä¸€)',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2023-04-10 19:21:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_1.css" ><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_2.css" ><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body>
    <div id='loader'>
        
            <div class="outer_box">
                <div class='loader_overlay'></div>
                <div class='loader_cogs'>
                    <div class='loader_cogs__top'>
                        <div class='top_part'></div>
                        <div class='top_part'></div>
                        <div class='top_part'></div>
                        <div class='top_hole'></div>
                    </div>
                    <div class='loader_cogs__left'>
                        <div class='left_part'></div>
                        <div class='left_part'></div>
                        <div class='left_part'></div>
                        <div class='left_hole'></div>
                    </div>
                    <div class='loader_cogs__bottom'>
                        <div class='bottom_part'></div>
                        <div class='bottom_part'></div>
                        <div class='bottom_part'></div>
                        <div class='bottom_hole'></div>
                    </div>
                    <p style="text-align:center">&nbsp;&nbsp;&nbsp;loading...</p>
                </div>
            </div>
        
    </div>

    <script>
        var endLoading = function () {
            document.body.style.overflow = 'auto';
            document.getElementById('loader').classList.add("loading");
        }
        window.addEventListener('load',endLoading);
    </script>

<div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/å¤´åƒ3.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´çº¿</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æµ©çƒ¬çš„åšå®¢</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´çº¿</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Solidityå­¦ä¹ ç¬”è®°(ä¸€)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-04-10T11:17:41.353Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-04-10T11:21:06.354Z" title="æ›´æ–°äº 2023-04-10 19:21:06">2023-04-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/">åŒºå—é“¾</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">9.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>35åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Solidityå­¦ä¹ ç¬”è®°(ä¸€)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Solidityå…¥é—¨"><a href="#Solidityå…¥é—¨" class="headerlink" title="Solidityå…¥é—¨"></a>Solidityå…¥é—¨</h1><p>å­¦ä¹ é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://wtf.academy/solidity-start/">https://wtf.academy/solidity-start/</a></p>
<h2 id="1-HelloWeb3"><a href="#1-HelloWeb3" class="headerlink" title="1.HelloWeb3"></a>1.HelloWeb3</h2><h3 id="ç¬¬ä¸€ä¸ªSolidityç¨‹åº"><a href="#ç¬¬ä¸€ä¸ªSolidityç¨‹åº" class="headerlink" title="ç¬¬ä¸€ä¸ªSolidityç¨‹åº"></a>ç¬¬ä¸€ä¸ªSolidityç¨‹åº</h3><p>å¾ˆç®€å•ï¼Œåªæœ‰1è¡Œæ³¨é‡Š+3è¡Œä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract HelloWeb3&#123;</span><br><span class="line">    string public _string = &quot;Hello Web3!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ‹†å¼€åˆ†æï¼Œå­¦ä¹ solidityä»£ç æºæ–‡ä»¶çš„ç»“æ„ï¼š</p>
<ol>
<li>ç¬¬1è¡Œæ˜¯æ³¨é‡Šï¼Œä¼šå†™ä¸€ä¸‹è¿™ä¸ªä»£ç æ‰€ç”¨çš„è½¯ä»¶è®¸å¯ï¼ˆlicenseï¼‰ï¼Œè¿™é‡Œç”¨çš„æ˜¯MIT licenseã€‚å¦‚æœä¸å†™è®¸å¯ï¼Œç¼–è¯‘æ—¶ä¼šè­¦å‘Šï¼ˆwarningï¼‰ï¼Œä½†ç¨‹åºå¯ä»¥è¿è¡Œã€‚solidityçš„æ³¨é‡Šç”±â€œ&#x2F;&#x2F;â€å¼€å¤´ï¼Œåé¢è·Ÿæ³¨é‡Šçš„å†…å®¹ï¼ˆä¸ä¼šè¢«ç¨‹åºè¿è¡Œï¼‰ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ç¬¬2è¡Œå£°æ˜æºæ–‡ä»¶æ‰€ç”¨çš„solidityç‰ˆæœ¬ï¼Œå› ä¸ºä¸åŒç‰ˆæœ¬è¯­æ³•æœ‰å·®åˆ«ã€‚è¿™è¡Œä»£ç æ„æ€æ˜¯æºæ–‡ä»¶å°†ä¸å…è®¸å°äº 0.8.4 ç‰ˆæœ¬æˆ–å¤§äºç­‰äº 0.9.0 ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ç¼–è¯‘ï¼ˆç¬¬äºŒä¸ªæ¡ä»¶ç”±<code>^</code>æä¾›ï¼‰ã€‚Solidity è¯­å¥ä»¥åˆ†å·ï¼ˆ;ï¼‰ç»“å°¾ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.8.4;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ç¬¬3-4è¡Œæ˜¯åˆçº¦éƒ¨åˆ†ï¼Œç¬¬3è¡Œåˆ›å»ºåˆçº¦ï¼ˆcontractï¼‰ï¼Œå¹¶å£°æ˜åˆçº¦çš„åå­— HelloWeb3ã€‚ç¬¬4è¡Œæ˜¯åˆçº¦çš„å†…å®¹ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªstringï¼ˆå­—ç¬¦ä¸²ï¼‰å˜é‡_stringï¼Œå¹¶ç»™ä»–èµ‹å€¼ â€œHello Web3!â€ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract HelloWeb3&#123;</span><br><span class="line">    string public _string = &quot;Hello Web3!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-æ•°å€¼ç±»å‹"><a href="#2-æ•°å€¼ç±»å‹" class="headerlink" title="2.æ•°å€¼ç±»å‹"></a>2.æ•°å€¼ç±»å‹</h2><p>åŒ…æ‹¬å¸ƒå°”å‹ï¼Œæ•´æ•°å‹ç­‰ç­‰ï¼Œè¿™ç±»å˜é‡èµ‹å€¼æ—¶å€™ç›´æ¥ä¼ é€’æ•°å€¼ã€‚</p>
<h3 id="å¸ƒå°”å‹"><a href="#å¸ƒå°”å‹" class="headerlink" title="å¸ƒå°”å‹"></a><strong>å¸ƒå°”å‹</strong></h3><p>å¸ƒå°”å‹æ˜¯äºŒå€¼å˜é‡ï¼Œå–å€¼ä¸º<code>true</code>æˆ–<code>false</code>ã€‚</p>
<p>å¸ƒå°”å€¼çš„è¿ç®—ç¬¦ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>! ï¼ˆé€»è¾‘éï¼‰</li>
<li>&amp;&amp; ï¼ˆé€»è¾‘ä¸ï¼Œ â€œandâ€ ï¼‰</li>
<li>|| ï¼ˆé€»è¾‘æˆ–ï¼Œ â€œorâ€ ï¼‰</li>
<li>&#x3D;&#x3D; ï¼ˆç­‰äºï¼‰</li>
<li>!&#x3D; ï¼ˆä¸ç­‰äºï¼‰</li>
</ul>
<p>å¸ƒå°”å‹è¿ç®—æ³¨æ„ç‚¹ï¼š<code>&amp;&amp;</code> å’Œ <code>||</code>è¿ç®—ç¬¦éµå¾ªçŸ­è·¯è§„åˆ™ï¼Œè¿™æ„å‘³ç€ï¼Œå‡å¦‚å­˜åœ¨<code>f(x) || g(y)</code>çš„è¡¨è¾¾å¼ï¼Œå¦‚æœ<code>f(x)</code>æ˜¯<code>true</code>ï¼Œ<code>g(y)</code>ä¸ä¼šè¢«è®¡ç®—ï¼Œå³ä½¿å®ƒå’Œ<code>f(x)</code>çš„ç»“æœæ˜¯ç›¸åçš„ã€‚</p>
<h3 id="æ•´å½¢"><a href="#æ•´å½¢" class="headerlink" title="æ•´å½¢"></a><strong>æ•´å½¢</strong></h3><p>æ•´å‹æ˜¯<code>solidity</code>ä¸­çš„æ•´æ•°ï¼Œæœ€å¸¸ç”¨çš„åŒ…æ‹¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// æ•´å‹</span><br><span class="line">   int public _int = -1; // æ•´æ•°ï¼ŒåŒ…æ‹¬è´Ÿæ•°</span><br><span class="line">   uint public _uint = 1; // æ­£æ•´æ•°</span><br><span class="line">   uint256 public _number = 20220330; // 256ä½æ­£æ•´æ•°</span><br></pre></td></tr></table></figure>

<p>å¸¸ç”¨çš„æ•´å‹è¿ç®—ç¬¦åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆè¿”å›å¸ƒå°”å€¼ï¼‰ï¼š <code>&lt;=</code>ï¼Œ <code>&lt;</code>ï¼Œ <code>==</code>ï¼Œ <code>!=</code>ï¼Œ <code>&gt;=</code>ï¼Œ <code>&gt;</code></li>
<li>ç®—æ•°è¿ç®—ç¬¦ï¼š <code>+</code>ï¼Œ <code>-</code>ï¼Œ ä¸€å…ƒè¿ç®— <code>-</code>ï¼Œ <code>+</code>ï¼Œ <code>*</code>ï¼Œ <code>/</code>ï¼Œ <code>%</code>ï¼ˆå–ä½™ï¼‰ï¼Œ<code>**</code>ï¼ˆå¹‚ï¼‰</li>
</ul>
<h3 id="åœ°å€ç±»å‹"><a href="#åœ°å€ç±»å‹" class="headerlink" title="åœ°å€ç±»å‹"></a><strong>åœ°å€ç±»å‹</strong></h3><p>åœ°å€ç±»å‹(address)å­˜å‚¨ä¸€ä¸ª <strong>20</strong> å­—èŠ‚çš„å€¼ï¼ˆä»¥å¤ªåŠåœ°å€çš„å¤§å°ï¼‰ã€‚åœ°å€ç±»å‹ä¹Ÿæœ‰æˆå‘˜å˜é‡ï¼Œå¹¶ä½œä¸ºæ‰€æœ‰åˆçº¦çš„åŸºç¡€ã€‚æœ‰æ™®é€šçš„åœ°å€å’Œå¯ä»¥è½¬è´¦<code>ETH</code>çš„åœ°å€ï¼ˆ<code>payable</code>ï¼‰ã€‚<code>payable</code>çš„åœ°å€æ‹¥æœ‰<code>balance</code>å’Œ<code>transfer()</code>ä¸¤ä¸ªæˆå‘˜ï¼Œæ–¹ä¾¿æŸ¥è¯¢<code>ETH</code>ä½™é¢ä»¥åŠè½¬è´¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// åœ°å€</span><br><span class="line">address public _address = 0x7A58c0Be72BE218B41C608b7Fe7C5bB630736C71;</span><br><span class="line">address payable public _address1 = payable(_address); // payable addressï¼Œå¯ä»¥è½¬è´¦ã€æŸ¥ä½™é¢</span><br><span class="line">// åœ°å€ç±»å‹çš„æˆå‘˜</span><br><span class="line">uint256 public balance = _address1.balance; // balance of address</span><br></pre></td></tr></table></figure>

<h3 id="å®šé•¿å­—èŠ‚æ•°ç»„"><a href="#å®šé•¿å­—èŠ‚æ•°ç»„" class="headerlink" title="å®šé•¿å­—èŠ‚æ•°ç»„"></a>å®šé•¿å­—èŠ‚æ•°ç»„</h3><p>å­—èŠ‚æ•°ç»„<code>bytes</code>åˆ†ä¸¤ç§ï¼Œä¸€ç§å®šé•¿ï¼ˆ<code>byte</code>, <code>bytes8</code>, <code>bytes32</code>ï¼‰ï¼Œå¦ä¸€ç§ä¸å®šé•¿ã€‚<strong>å®šé•¿çš„å±äºæ•°å€¼ç±»å‹ï¼Œä¸å®šé•¿çš„æ˜¯å¼•ç”¨ç±»å‹</strong>ï¼ˆä¹‹åè®²ï¼‰ã€‚ å®šé•¿<code>bytes</code>å¯ä»¥å­˜ä¸€äº›æ•°æ®ï¼Œæ¶ˆè€—<code>gas</code>æ¯”è¾ƒå°‘ã€‚</p>
<h3 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h3><p>æšä¸¾ï¼ˆ<code>enum</code>ï¼‰æ˜¯<code>solidity</code>ä¸­ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ã€‚å®ƒä¸»è¦ç”¨äºä¸º<code>uint</code>åˆ†é…åç§°ï¼Œä½¿ç¨‹åºæ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚å®ƒä¸<code>Cè¯­è¨€</code>ä¸­çš„<code>enum</code>ç±»ä¼¼ï¼Œä½¿ç”¨åç§°æ¥ä»£æ›¿ä»<code>0</code>å¼€å§‹çš„<code>uint</code>ï¼š</p>
<pre><code>// ç”¨enumå°†uint 0ï¼Œ 1ï¼Œ 2è¡¨ç¤ºä¸ºBuy, Hold, Sell
enum ActionSet &#123; Buy, Hold, Sell &#125;
// åˆ›å»ºenumå˜é‡ action
ActionSet action = ActionSet.Buy;
</code></pre>
<p>ç»ƒä¹ é¢˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">address payable addr;</span><br><span class="line">addr.transfer(1);</span><br></pre></td></tr></table></figure>

<p>æ„ä¸ºï¼š</p>
<ul>
<li><p>è°ƒç”¨è€…å‘åˆçº¦è½¬è´¦1wei  âˆš</p>
</li>
<li><p>è°ƒç”¨è€…å‘addrè½¬è´¦1wei</p>
</li>
<li><p>åˆçº¦å‘addrè½¬è´¦1wei</p>
</li>
<li><p>åˆçº¦å‘addrè½¬è´¦1ether</p>
</li>
</ul>
<h2 id="3-å‡½æ•°ç±»å‹"><a href="#3-å‡½æ•°ç±»å‹" class="headerlink" title="3.å‡½æ•°ç±»å‹"></a>3.å‡½æ•°ç±»å‹</h2><p>solidityå®˜æ–¹æ–‡æ¡£é‡ŒæŠŠå‡½æ•°å½’åˆ°æ•°å€¼ç±»å‹ï¼Œä½†æˆ‘è§‰å¾—å·®åˆ«å¾ˆå¤§ï¼Œæ‰€ä»¥å•ç‹¬åˆ†ä¸€ç±»ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹solidityä¸­å‡½æ•°çš„å½¢å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function &lt;function name&gt; (&lt;parameter types&gt;) &#123;internal|external|public|private&#125; [pure|view|payable] [returns (&lt;return types&gt;)]</span><br></pre></td></tr></table></figure>

<p>çœ‹ç€æœ‰äº›å¤æ‚ï¼Œå’±ä»¬ä»å‰å¾€åä¸€ä¸ªä¸€ä¸ªçœ‹ï¼ˆæ–¹æ‹¬å·ä¸­çš„æ˜¯å¯å†™å¯ä¸å†™çš„å…³é”®å­—ï¼‰ï¼š</p>
<ol>
<li><code>function</code>ï¼šå£°æ˜å‡½æ•°æ—¶çš„å›ºå®šç”¨æ³•ï¼Œæƒ³å†™å‡½æ•°ï¼Œå°±è¦ä»¥functionå…³é”®å­—å¼€å¤´ã€‚</li>
<li><code>&lt;function name&gt;</code>ï¼šå‡½æ•°åã€‚</li>
<li><code>(&lt;parameter types&gt;)</code>ï¼šåœ†æ‹¬å·é‡Œå†™å‡½æ•°çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¦è¾“å…¥åˆ°å‡½æ•°çš„å˜é‡ç±»å‹å’Œåå­—ã€‚</li>
<li><code>&#123;internal|external|public|private&#125;</code>ï¼šå‡½æ•°å¯è§æ€§è¯´æ˜ç¬¦ï¼Œä¸€å…±4ç§ã€‚æ²¡æ ‡æ˜å‡½æ•°ç±»å‹çš„ï¼Œé»˜è®¤<code>internal</code>ã€‚<ul>
<li><code>public</code>: å†…éƒ¨å¤–éƒ¨å‡å¯è§ã€‚(ä¹Ÿå¯ç”¨äºä¿®é¥°çŠ¶æ€å˜é‡ï¼Œpublicå˜é‡ä¼šè‡ªåŠ¨ç”Ÿæˆ <code>getter</code>å‡½æ•°ï¼Œç”¨äºæŸ¥è¯¢æ•°å€¼).</li>
<li><code>private</code>: åªèƒ½ä»æœ¬åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦ä¹Ÿä¸èƒ½ç”¨ï¼ˆä¹Ÿå¯ç”¨äºä¿®é¥°çŠ¶æ€å˜é‡ï¼‰ã€‚</li>
<li><code>external</code>: åªèƒ½ä»åˆçº¦å¤–éƒ¨è®¿é—®ï¼ˆä½†æ˜¯å¯ä»¥ç”¨<code>this.f()</code>æ¥è°ƒç”¨ï¼Œ<code>f</code>æ˜¯å‡½æ•°åï¼‰</li>
<li><code>internal</code>: åªèƒ½ä»åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦å¯ä»¥ç”¨ï¼ˆä¹Ÿå¯ç”¨äºä¿®é¥°çŠ¶æ€å˜é‡ï¼‰ã€‚</li>
</ul>
</li>
<li><code>[pure|view|payable]</code>ï¼šå†³å®šå‡½æ•°æƒé™&#x2F;åŠŸèƒ½çš„å…³é”®å­—ã€‚<code>payable</code>ï¼ˆå¯æ”¯ä»˜çš„ï¼‰å¾ˆå¥½ç†è§£ï¼Œå¸¦ç€å®ƒçš„å‡½æ•°ï¼Œè¿è¡Œçš„æ—¶å€™å¯ä»¥ç»™åˆçº¦è½¬å…¥<code>ETH</code>ã€‚<code>pure</code>å’Œ<code>view</code>çš„ä»‹ç»è§ä¸‹ä¸€èŠ‚ã€‚</li>
<li><code>[returns ()]</code>ï¼šå‡½æ•°è¿”å›çš„å˜é‡ç±»å‹å’Œåç§°ã€‚</li>
</ol>
<h3 id="åˆ°åº•ä»€ä¹ˆæ˜¯Pureå’ŒViewï¼Ÿ"><a href="#åˆ°åº•ä»€ä¹ˆæ˜¯Pureå’ŒViewï¼Ÿ" class="headerlink" title="åˆ°åº•ä»€ä¹ˆæ˜¯Pureå’ŒViewï¼Ÿ"></a><strong>åˆ°åº•ä»€ä¹ˆæ˜¯<code>Pure</code>å’Œ<code>View</code>ï¼Ÿ</strong></h3><p>æˆ‘åˆšå¼€å§‹å­¦<code>solidity</code>çš„æ—¶å€™ï¼Œä¸€ç›´ä¸ç†è§£<code>pure</code>è·Ÿ<code>view</code>å…³é”®å­—ï¼Œå› ä¸ºåˆ«çš„è¯­è¨€æ²¡æœ‰ç±»ä¼¼çš„å…³é”®å­—ã€‚<code>solidity</code>åŠ å…¥è¿™ä¸¤ä¸ªå…³é”®å­—ï¼Œæˆ‘è®¤ä¸ºæ˜¯å› ä¸º<code>gas fee</code>ã€‚åˆçº¦çš„çŠ¶æ€å˜é‡å­˜å‚¨åœ¨é“¾ä¸Šï¼Œ<code>gas fee</code>å¾ˆè´µï¼Œå¦‚æœä¸æ”¹å˜é“¾ä¸ŠçŠ¶æ€ï¼Œå°±ä¸ç”¨ä»˜<code>gas</code>ã€‚åŒ…å«<code>pure</code>è·Ÿ<code>view</code>å…³é”®å­—çš„å‡½æ•°æ˜¯ä¸æ”¹å†™é“¾ä¸ŠçŠ¶æ€çš„ï¼Œå› æ­¤ç”¨æˆ·ç›´æ¥è°ƒç”¨ä»–ä»¬æ˜¯ä¸éœ€è¦ä»˜gasçš„ï¼ˆåˆçº¦ä¸­é<code>pure</code>&#x2F;<code>view</code>å‡½æ•°è°ƒç”¨å®ƒä»¬åˆ™ä¼šæ”¹å†™é“¾ä¸ŠçŠ¶æ€ï¼Œéœ€è¦ä»˜gasï¼‰ã€‚</p>
<p>åœ¨ä»¥å¤ªåŠä¸­ï¼Œä»¥ä¸‹è¯­å¥è¢«è§†ä¸ºä¿®æ”¹é“¾ä¸ŠçŠ¶æ€ï¼š</p>
<ol>
<li>å†™å…¥çŠ¶æ€å˜é‡ã€‚</li>
<li>é‡Šæ”¾äº‹ä»¶ã€‚</li>
<li>åˆ›å»ºå…¶ä»–åˆåŒã€‚</li>
<li>ä½¿ç”¨<code>selfdestruct</code>.</li>
<li>é€šè¿‡è°ƒç”¨å‘é€ä»¥å¤ªå¸ã€‚</li>
<li>è°ƒç”¨ä»»ä½•æœªæ ‡è®°<code>view</code>æˆ–<code>pure</code>çš„å‡½æ•°ã€‚</li>
<li>ä½¿ç”¨ä½çº§è°ƒç”¨ï¼ˆlow-level callsï¼‰ã€‚</li>
<li>ä½¿ç”¨åŒ…å«æŸäº›æ“ä½œç çš„å†…è”æ±‡ç¼–ã€‚</li>
</ol>
<p>æˆ‘ç”»äº†ä¸€ä¸ªé©¬é‡Œå¥¥æ’ç”»ï¼Œå¸®åŠ©å¤§å®¶ç†è§£ã€‚åœ¨æ’ç”»é‡Œï¼Œæˆ‘æŠŠåˆçº¦ä¸­çš„çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨åœ¨é“¾ä¸Šï¼‰æ¯”ä½œç¢§æ± å…¬ä¸»ï¼Œä¸‰ç§ä¸åŒçš„è§’è‰²ä»£è¡¨ä¸åŒçš„å…³é”®å­—ã€‚</p>
<p><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221010220429146.png" alt="image-20221010220429146"></p>
<ul>
<li><code>pure</code>ï¼Œä¸­æ–‡æ„æ€æ˜¯â€œçº¯â€ï¼Œåœ¨<code>solidity</code>é‡Œç†è§£ä¸ºâ€œçº¯çº¯ç‰›é©¬â€ã€‚åŒ…å«<code>pure</code>å…³é”®å­—çš„å‡½æ•°ï¼Œ<strong>ä¸èƒ½è¯»å–ä¹Ÿä¸èƒ½å†™å…¥å­˜å‚¨åœ¨é“¾ä¸Šçš„çŠ¶æ€å˜é‡</strong>ã€‚å°±åƒå°æ€ªä¸€æ ·ï¼Œçœ‹ä¸åˆ°ä¹Ÿæ‘¸ä¸åˆ°ç¢§æ± å…¬ä¸»ã€‚</li>
<li><code>view</code>ï¼Œâ€œçœ‹â€ï¼Œåœ¨<code>solidity</code>é‡Œç†è§£ä¸ºâ€œçœ‹å®¢â€ã€‚åŒ…å«<code>view</code>å…³é”®å­—çš„å‡½æ•°ï¼Œ<strong>èƒ½è¯»å–ä½†ä¹Ÿä¸èƒ½å†™å…¥çŠ¶æ€å˜é‡</strong>ã€‚ç±»ä¼¼é©¬é‡Œå¥¥ï¼Œèƒ½çœ‹åˆ°ç¢§æ± ï¼Œä½†ç»ˆç©¶æ˜¯çœ‹å®¢ï¼Œä¸èƒ½å…¥æ´æˆ¿ã€‚</li>
<li>ä¸å†™<code>pure</code>ä¹Ÿä¸å†™<code>view</code>ï¼Œå‡½æ•°æ—¢å¯ä»¥è¯»å–ä¹Ÿå¯ä»¥å†™å…¥çŠ¶æ€å˜é‡ã€‚ç±»ä¼¼é©¬é‡Œå¥¥é‡Œçš„<code>boss</code>ï¼Œå¯ä»¥å¯¹ç¢§æ± å…¬ä¸»ä¸ºæ‰€æ¬²ä¸ºğŸ¶ã€‚</li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="1-pure-v-s-view"><a href="#1-pure-v-s-view" class="headerlink" title="1. pure v.s. view"></a>1. pure v.s. view</h4><p>æˆ‘ä»¬åœ¨åˆçº¦é‡Œå®šä¹‰ä¸€ä¸ªçŠ¶æ€å˜é‡ <code>number = 5</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract FunctionTypes&#123;</span><br><span class="line">    uint256 public number = 5;</span><br></pre></td></tr></table></figure>

<p>å®šä¹‰ä¸€ä¸ª<code>add()</code>å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ï¼Œæ¯æ¬¡ç»™<code>number + 1</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// é»˜è®¤</span><br><span class="line">function add() external&#123;</span><br><span class="line">    number = number + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>add()</code>åŒ…å«äº†<code>pure</code>å…³é”®å­—ï¼Œä¾‹å¦‚ <code>function add() pure external</code>ï¼Œå°±ä¼šæŠ¥é”™ã€‚å› ä¸º<code>pure</code>ï¼ˆçº¯çº¯ç‰›é©¬ï¼‰æ˜¯ä¸é…è¯»å–åˆçº¦é‡Œçš„çŠ¶æ€å˜é‡çš„ï¼Œæ›´ä¸é…æ”¹å†™ã€‚é‚£<code>pure</code>å‡½æ•°èƒ½åšäº›ä»€ä¹ˆï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥ç»™å‡½æ•°ä¼ é€’ä¸€ä¸ªå‚æ•° <code>_number</code>ï¼Œç„¶åè®©ä»–è¿”å› <code>_number+1</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// pure: çº¯çº¯ç‰›é©¬</span><br><span class="line">function addPure(uint256 _number) external pure returns(uint256 new_number)&#123;</span><br><span class="line">    new_number = _number+1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Example:</strong></p>
<p><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142441360.png" alt="image-20221013142441360"></p>
<p>å¦‚æœ<code>add()</code>åŒ…å«<code>view</code>ï¼Œæ¯”å¦‚<code>function add() view external</code>ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚å› ä¸º<code>view</code>èƒ½è¯»å–ï¼Œä½†ä¸èƒ½å¤Ÿæ”¹å†™çŠ¶æ€å˜é‡ã€‚å¯ä»¥ç¨å¾®æ”¹å†™ä¸‹æ–¹ç¨‹ï¼Œè®©ä»–ä¸æ”¹å†™<code>number</code>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å˜é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// view: çœ‹å®¢</span><br><span class="line">function addView() external view returns(uint256 new_number) &#123;</span><br><span class="line">    new_number = number + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142513165.png" alt="image-20221013142513165"></p>
<h4 id="2-internal-v-s-external"><a href="#2-internal-v-s-external" class="headerlink" title="2. internal v.s. external"></a>2. internal v.s. external</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// internal: å†…éƒ¨</span><br><span class="line">function minus() internal &#123;</span><br><span class="line">    number = number - 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆçº¦å†…çš„å‡½æ•°å¯ä»¥è°ƒç”¨å†…éƒ¨å‡½æ•°</span><br><span class="line">function minusCall() external &#123;</span><br><span class="line">    minus();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>internal</code>çš„<code>minus()</code>å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ä½¿å¾—<code>number</code>å˜é‡å‡1ã€‚ç”±äºæ˜¯<code>internal</code>ï¼Œåªèƒ½ç”±åˆçº¦å†…éƒ¨è°ƒç”¨ï¼Œè€Œå¤–éƒ¨ä¸èƒ½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å†å®šä¹‰ä¸€ä¸ª<code>external</code>çš„<code>minusCall()</code>å‡½æ•°ï¼Œæ¥é—´æ¥è°ƒç”¨å†…éƒ¨çš„<code>minus()</code>ã€‚ <strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142554855.png" alt="image-20221013142554855"></p>
<h4 id="3-payable"><a href="#3-payable" class="headerlink" title="3. payable"></a>3. payable</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// payable: é€’é’±ï¼Œèƒ½ç»™åˆçº¦æ”¯ä»˜ethçš„å‡½æ•°</span><br><span class="line">function minusPayable() external payable returns(uint256 balance) &#123;</span><br><span class="line">    minus();    </span><br><span class="line">    balance = address(this).balance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>external payable</code>çš„<code>minusPayable()</code>å‡½æ•°ï¼Œé—´æ¥çš„è°ƒç”¨<code>minus()</code>ï¼Œå¹¶ä¸”è¿”å›åˆçº¦é‡Œçš„<code>ETH</code>ä½™é¢ï¼ˆ<code>this</code>å…³é”®å­—å¯ä»¥è®©æˆ‘ä»¬å¼•ç”¨åˆçº¦åœ°å€)ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨<code>minusPayable()</code>æ—¶ï¼Œå¾€åˆçº¦é‡Œè½¬å…¥1ä¸ª<code>ETH</code>ã€‚</p>
<p><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142624937.png" alt="image-20221013142624937"></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨è¿”å›çš„ä¿¡æ¯ä¸­çœ‹åˆ°ï¼Œåˆçº¦çš„ä½™é¢æ˜¯1 ETHã€‚</p>
<p><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142644082.png" alt="image-20221013142644082"></p>
<p><strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221013142707827.png" alt="image-20221013142707827"></p>
<h3 id="å‡½æ•°è¾“å‡º"><a href="#å‡½æ•°è¾“å‡º" class="headerlink" title="å‡½æ•°è¾“å‡º"></a>å‡½æ•°è¾“å‡º</h3><h4 id="è¿”å›å€¼-returnå’Œreturns"><a href="#è¿”å›å€¼-returnå’Œreturns" class="headerlink" title="è¿”å›å€¼ returnå’Œreturns"></a>è¿”å›å€¼ returnå’Œreturns</h4><p><code>Solidity</code>æœ‰ä¸¤ä¸ªå…³é”®å­—ä¸å‡½æ•°è¾“å‡ºç›¸å…³ï¼š<code>return</code>å’Œ<code>returns</code>ï¼Œä»–ä»¬çš„åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li><code>returns</code>åŠ åœ¨å‡½æ•°ååé¢ï¼Œç”¨äºå£°æ˜è¿”å›çš„å˜é‡ç±»å‹åŠå˜é‡åï¼›</li>
<li><code>return</code>ç”¨äºå‡½æ•°ä¸»ä½“ä¸­ï¼Œè¿”å›æŒ‡å®šçš„å˜é‡ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// è¿”å›å¤šä¸ªå˜é‡</span><br><span class="line">function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">        return(1, true, [uint256(1),2,5]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†<code>returnMultiple()</code>å‡½æ•°å°†æœ‰å¤šä¸ªè¾“å‡ºï¼š<code>returns(uint256, bool, uint256[3] memory)</code>ï¼Œæ¥ç€æˆ‘ä»¬åœ¨å‡½æ•°ä¸»ä½“ä¸­ç”¨<code>return(1, true, [uint256(1),2,5])</code>ç¡®å®šäº†è¿”å›å€¼ã€‚</p>
<h4 id="å‘½åå¼è¿”å›"><a href="#å‘½åå¼è¿”å›" class="headerlink" title="å‘½åå¼è¿”å›"></a>å‘½åå¼è¿”å›</h4><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>returns</code>ä¸­æ ‡æ˜è¿”å›å˜é‡çš„åç§°ï¼Œè¿™æ ·<code>solidity</code>ä¼šè‡ªåŠ¨ç»™è¿™äº›å˜é‡åˆå§‹åŒ–ï¼Œå¹¶ä¸”è‡ªåŠ¨è¿”å›è¿™äº›å‡½æ•°çš„å€¼ï¼Œä¸éœ€è¦åŠ <code>return</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å‘½åå¼è¿”å›</span><br><span class="line">function returnNamed() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">    _number = 2;</span><br><span class="line">    _bool = false; </span><br><span class="line">    _array = [uint256(3),2,1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>returns(uint256 _number, bool _bool, uint256[3] memory _array)</code>å£°æ˜äº†è¿”å›å˜é‡ç±»å‹ä»¥åŠå˜é‡åã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨ä¸»ä½“ä¸­åªéœ€è¦ç»™å˜é‡<code>_number</code>ï¼Œ<code>_bool</code>å’Œ<code>_array</code>èµ‹å€¼å°±å¯ä»¥è‡ªåŠ¨è¿”å›äº†ã€‚</p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å‘½åå¼è¿”å›ä¸­ç”¨<code>return</code>æ¥è¿”å›å˜é‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å‘½åå¼è¿”å›ï¼Œä¾ç„¶æ”¯æŒreturn</span><br><span class="line">function returnNamed2() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">    return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è§£æ„å¼èµ‹å€¼"><a href="#è§£æ„å¼èµ‹å€¼" class="headerlink" title="è§£æ„å¼èµ‹å€¼"></a>è§£æ„å¼èµ‹å€¼</h4><p><code>solidity</code>ä½¿ç”¨è§£æ„å¼èµ‹å€¼çš„è§„åˆ™ï¼Œæ”¯æŒè¯»å–å‡½æ•°çš„å…¨éƒ¨æˆ–éƒ¨åˆ†è¿”å›å€¼ã€‚</p>
<ul>
<li>è¯»å–æ‰€æœ‰è¿”å›å€¼ï¼šå£°æ˜å˜é‡ï¼Œå¹¶ä¸”å°†è¦èµ‹å€¼çš„å˜é‡ç”¨<code>,</code>éš”å¼€ï¼ŒæŒ‰é¡ºåºæ’åˆ—ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint256 _number;</span><br><span class="line">bool _bool;</span><br><span class="line">uint256[3] memory _array;</span><br><span class="line">(_number, _bool, _array) = returnNamed();</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯»å–éƒ¨åˆ†è¿”å›å€¼ï¼šå£°æ˜è¦è¯»å–çš„è¿”å›å€¼å¯¹åº”çš„å˜é‡ï¼Œä¸è¯»å–çš„ç•™ç©ºã€‚ä¸‹é¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬åªè¯»å–<code>_bool</code>ï¼Œè€Œä¸è¯»å–è¿”å›çš„<code>_number</code>å’Œ<code>_array</code>ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(, _bool2, ) = returnNamed();</span><br></pre></td></tr></table></figure>

<h2 id="4-å¼•ç”¨ç±»å‹"><a href="#4-å¼•ç”¨ç±»å‹" class="headerlink" title="4.å¼•ç”¨ç±»å‹"></a>4.å¼•ç”¨ç±»å‹</h2><p>**å¼•ç”¨ç±»å‹(Reference Type)**ï¼šåŒ…æ‹¬æ•°ç»„ï¼ˆ<code>array</code>ï¼‰ï¼Œç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰å’Œæ˜ å°„ï¼ˆ<code>mapping</code>ï¼‰ï¼Œè¿™ç±»å˜é‡å ç©ºé—´å¤§ï¼Œèµ‹å€¼æ—¶å€™ç›´æ¥ä¼ é€’åœ°å€ï¼ˆç±»ä¼¼æŒ‡é’ˆï¼‰ã€‚ç”±äºè¿™ç±»å˜é‡æ¯”è¾ƒå¤æ‚ï¼Œå ç”¨å­˜å‚¨ç©ºé—´å¤§ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å¿…é¡»è¦å£°æ˜æ•°æ®å­˜å‚¨çš„ä½ç½®ã€‚</p>
<h3 id="æ•°æ®ä½ç½®"><a href="#æ•°æ®ä½ç½®" class="headerlink" title="æ•°æ®ä½ç½®"></a>æ•°æ®ä½ç½®</h3><p>solidityæ•°æ®å­˜å‚¨ä½ç½®æœ‰ä¸‰ç±»ï¼š<code>storage</code>ï¼Œ<code>memory</code>å’Œ<code>calldata</code>ã€‚ä¸åŒå­˜å‚¨ä½ç½®çš„<code>gas</code>æˆæœ¬ä¸åŒã€‚<code>storage</code>ç±»å‹çš„æ•°æ®å­˜åœ¨é“¾ä¸Šï¼Œç±»ä¼¼è®¡ç®—æœºçš„ç¡¬ç›˜ï¼Œæ¶ˆè€—<code>gas</code>å¤šï¼›<code>memory</code>å’Œ<code>calldata</code>ç±»å‹çš„ä¸´æ—¶å­˜åœ¨å†…å­˜é‡Œï¼Œæ¶ˆè€—<code>gas</code>å°‘ã€‚å¤§è‡´ç”¨æ³•ï¼š</p>
<ol>
<li><code>storage</code>ï¼šåˆçº¦é‡Œçš„çŠ¶æ€å˜é‡<strong>é»˜è®¤</strong>éƒ½æ˜¯<code>storage</code>ï¼Œå­˜å‚¨åœ¨é“¾ä¸Šã€‚</li>
<li><code>memory</code>ï¼šå‡½æ•°é‡Œçš„å‚æ•°å’Œä¸´æ—¶å˜é‡ä¸€èˆ¬ç”¨<code>memory</code>ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ä¸Šé“¾ã€‚</li>
<li><code>calldata</code>ï¼šå’Œ<code>memory</code>ç±»ä¼¼ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ä¸Šé“¾ã€‚ä¸<code>memory</code>çš„ä¸åŒç‚¹åœ¨äº<code>calldata</code>å˜é‡ä¸èƒ½ä¿®æ”¹ï¼ˆ<code>immutable</code>ï¼‰ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°çš„å‚æ•°ã€‚ä¾‹å­ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata)&#123;</span><br><span class="line">      //å‚æ•°ä¸ºcalldataæ•°ç»„ï¼Œä¸èƒ½è¢«ä¿®æ”¹</span><br><span class="line">      // _x[0] = 0 //è¿™æ ·ä¿®æ”¹ä¼šæŠ¥é”™</span><br><span class="line">      return(_x);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221012200146841.png" alt="image-20221012200146841"></p>
<h4 id="æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™"><a href="#æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™" class="headerlink" title="æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™"></a>æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™</h4><p>åœ¨ä¸åŒå­˜å‚¨ç±»å‹ç›¸äº’èµ‹å€¼æ—¶å€™ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿç‹¬ç«‹çš„å‰¯æœ¬ï¼ˆä¿®æ”¹æ–°å˜é‡ä¸ä¼šå½±å“åŸå˜é‡ï¼‰ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿå¼•ç”¨ï¼ˆä¿®æ”¹æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ï¼‰ã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>storage</code>ï¼ˆåˆçº¦çš„çŠ¶æ€å˜é‡ï¼‰èµ‹å€¼ç»™æœ¬åœ°<code>storage</code>ï¼ˆå‡½æ•°é‡Œçš„ï¼‰æ—¶å€™ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚ä¾‹å­ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">uint[] x = [1,2,3]; // çŠ¶æ€å˜é‡ï¼šæ•°ç»„ x</span><br><span class="line"></span><br><span class="line">function fStorage() public&#123;</span><br><span class="line">    //å£°æ˜ä¸€ä¸ªstorageçš„å˜é‡ xStorageï¼ŒæŒ‡å‘xã€‚ä¿®æ”¹xStorageä¹Ÿä¼šå½±å“x</span><br><span class="line">    uint[] storage xStorage = x;</span><br><span class="line">    xStorage[0] = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221012195427436.png" alt="image-20221012195427436"></p>
<ol start="2">
<li><code>storage</code>èµ‹å€¼ç»™<code>memory</code>ï¼Œä¼šåˆ›å»ºç‹¬ç«‹çš„å¤æœ¬ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ªï¼›åä¹‹äº¦ç„¶ã€‚ä¾‹å­ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">uint[] x = [1,2,3]; // çŠ¶æ€å˜é‡ï¼šæ•°ç»„ x</span><br><span class="line"></span><br><span class="line">function fMemory() public view&#123;</span><br><span class="line">    //å£°æ˜ä¸€ä¸ªMemoryçš„å˜é‡xMemoryï¼Œå¤åˆ¶xã€‚ä¿®æ”¹xMemoryä¸ä¼šå½±å“x</span><br><span class="line">    uint[] memory xMemory = x;</span><br><span class="line">    xMemory[0] = 100;</span><br><span class="line">    xMemory[1] = 200;</span><br><span class="line">    uint[] memory xMemory2 = x;</span><br><span class="line">    xMemory2[0] = 300;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Example:</strong> <img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221012195644598.png" alt="image-20221012195644598"></p>
<ol start="3">
<li><p><code>memory</code>èµ‹å€¼ç»™<code>memory</code>ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚</p>
</li>
<li><p>å…¶ä»–æƒ…å†µï¼Œå˜é‡èµ‹å€¼ç»™<code>storage</code>ï¼Œä¼šåˆ›å»ºç‹¬ç«‹çš„å¤æœ¬ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ªã€‚</p>
</li>
</ol>
<h4 id="å˜é‡çš„ä½œç”¨åŸŸ"><a href="#å˜é‡çš„ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡çš„ä½œç”¨åŸŸ"></a>å˜é‡çš„ä½œç”¨åŸŸ</h4><p><code>Solidity</code>ä¸­å˜é‡æŒ‰ä½œç”¨åŸŸåˆ’åˆ†æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯çŠ¶æ€å˜é‡ï¼ˆstate variableï¼‰ï¼Œå±€éƒ¨å˜é‡ï¼ˆlocal variableï¼‰å’Œå…¨å±€å˜é‡(global variable)</p>
<h5 id="1-çŠ¶æ€å˜é‡"><a href="#1-çŠ¶æ€å˜é‡" class="headerlink" title="1. çŠ¶æ€å˜é‡"></a>1. çŠ¶æ€å˜é‡</h5><p>çŠ¶æ€å˜é‡æ˜¯æ•°æ®å­˜å‚¨åœ¨é“¾ä¸Šçš„å˜é‡ï¼Œæ‰€æœ‰åˆçº¦å†…å‡½æ•°éƒ½å¯ä»¥è®¿é—® ï¼Œ<code>gas</code>æ¶ˆè€—é«˜ã€‚çŠ¶æ€å˜é‡åœ¨åˆçº¦å†…ã€å‡½æ•°å¤–å£°æ˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">contract Variables &#123;</span><br><span class="line">    uint public x = 1;</span><br><span class="line">    uint public y;</span><br><span class="line">    string public z;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹çŠ¶æ€å˜é‡çš„å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo() external&#123;</span><br><span class="line">    // å¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹çŠ¶æ€å˜é‡çš„å€¼</span><br><span class="line">    x = 5;</span><br><span class="line">    y = 2;</span><br><span class="line">    z = &quot;0xAA&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-å±€éƒ¨å˜é‡"><a href="#2-å±€éƒ¨å˜é‡" class="headerlink" title="2. å±€éƒ¨å˜é‡"></a>2. å±€éƒ¨å˜é‡</h5><p>å±€éƒ¨å˜é‡æ˜¯ä»…åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆçš„å˜é‡ï¼Œå‡½æ•°é€€å‡ºåï¼Œå˜é‡æ— æ•ˆã€‚å±€éƒ¨å˜é‡çš„æ•°æ®å­˜å‚¨åœ¨å†…å­˜é‡Œï¼Œä¸ä¸Šé“¾ï¼Œ<code>gas</code>ä½ã€‚å±€éƒ¨å˜é‡åœ¨å‡½æ•°å†…å£°æ˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function bar() external pure returns(uint)&#123;</span><br><span class="line">    uint xx = 1;</span><br><span class="line">    uint yy = 3;</span><br><span class="line">    uint zz = xx + yy;</span><br><span class="line">    return(zz);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-å…¨å±€å˜é‡"><a href="#3-å…¨å±€å˜é‡" class="headerlink" title="3. å…¨å±€å˜é‡"></a>3. å…¨å±€å˜é‡</h5><p>å…¨å±€å˜é‡æ˜¯å…¨å±€èŒƒå›´å·¥ä½œçš„å˜é‡ï¼Œéƒ½æ˜¯<code>solidity</code>é¢„ç•™å…³é”®å­—ã€‚ä»–ä»¬å¯ä»¥åœ¨å‡½æ•°å†…ä¸å£°æ˜ç›´æ¥ä½¿ç”¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function global() external view returns(address, uint, bytes memory)&#123;</span><br><span class="line">    address sender = msg.sender;</span><br><span class="line">    uint blockNum = block.number;</span><br><span class="line">    bytes memory data = msg.data;</span><br><span class="line">    return(sender, blockNum, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åœ¨ä¸Šé¢ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†3ä¸ªå¸¸ç”¨çš„å…¨å±€å˜é‡ï¼š<code>msg.sender</code>, <code>block.number</code>å’Œ<code>msg.data</code>ï¼Œä»–ä»¬åˆ†åˆ«ä»£è¡¨è¯·æ±‚å‘èµ·åœ°å€ï¼Œå½“å‰åŒºå—é«˜åº¦ï¼Œå’Œè¯·æ±‚æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å…¨å±€å˜é‡ï¼Œæ›´å®Œæ•´çš„åˆ—è¡¨è¯·çœ‹è¿™ä¸ª<a target="_blank" rel="noopener" href="https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions">é“¾æ¥</a>ï¼š</p>
<ul>
<li><code>blockhash(uint blockNumber)</code>: (<code>bytes32</code>)ç»™å®šåŒºå—çš„å“ˆå¸Œå€¼ â€“ åªé€‚ç”¨äº256æœ€è¿‘åŒºå—, ä¸åŒ…å«å½“å‰åŒºå—ã€‚</li>
<li><code>block.coinbase</code>: (<code>address payable</code>) å½“å‰åŒºå—çŸ¿å·¥çš„åœ°å€</li>
<li><code>block.gaslimit</code>: (<code>uint</code>) å½“å‰åŒºå—çš„gaslimit</li>
<li><code>block.number</code>: (<code>uint</code>) å½“å‰åŒºå—çš„number</li>
<li><code>block.timestamp</code>: (<code>uint</code>) å½“å‰åŒºå—çš„æ—¶é—´æˆ³ï¼Œä¸ºunixçºªå…ƒä»¥æ¥çš„ç§’</li>
<li><code>gasleft()</code>: (<code>uint256</code>) å‰©ä½™ gas</li>
<li><code>msg.data</code>: (<code>bytes calldata</code>) å®Œæ•´call data</li>
<li><code>msg.sender</code>: (<code>address payable</code>) æ¶ˆæ¯å‘é€è€… (å½“å‰ caller)</li>
<li><code>msg.sig</code>: (<code>bytes4</code>) calldataçš„å‰å››ä¸ªå­—èŠ‚ (function identifier)</li>
<li><code>msg.value</code>: (<code>uint</code>) å½“å‰äº¤æ˜“å‘é€çš„<code>wei</code>å€¼</li>
</ul>
<p><strong>Example:</strong><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221012200905730.png" alt="image-20221012200905730"></p>
<p><strong>æ³¨æ„ï¼šè¿™é‡Œè¦åŒºåˆ†å¥½çŠ¶æ€å˜é‡å’Œå…¨å±€å˜é‡çš„åŒºåˆ«ã€‚çŠ¶æ€å˜é‡å¯ä»¥ç†è§£ä¸ºè‡ªå®šä¹‰çš„å…¨å±€å˜é‡(è¯¥å˜é‡ä¼šä¸Šé“¾)ï¼Œè€Œå…¨å±€å˜é‡ä¸ºsolidityé¢„ç•™çš„å…³é”®å­—å¦‚msg.senderç­‰</strong></p>
<h3 id="æ•°ç»„-array"><a href="#æ•°ç»„-array" class="headerlink" title="æ•°ç»„ array"></a>æ•°ç»„ array</h3><p>æ•°ç»„ï¼ˆ<code>Array</code>ï¼‰æ˜¯<code>solidity</code>å¸¸ç”¨çš„ä¸€ç§å˜é‡ç±»å‹ï¼Œç”¨æ¥å­˜å‚¨ä¸€ç»„æ•°æ®ï¼ˆæ•´æ•°ï¼Œå­—èŠ‚ï¼Œåœ°å€ç­‰ç­‰ï¼‰ã€‚æ•°ç»„åˆ†ä¸ºå›ºå®šé•¿åº¦æ•°ç»„å’Œå¯å˜é•¿åº¦æ•°ç»„ä¸¤ç§ï¼š</p>
<ul>
<li>å›ºå®šé•¿åº¦æ•°ç»„ï¼šåœ¨å£°æ˜æ—¶æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚ç”¨<code>T[k]</code>çš„æ ¼å¼å£°æ˜ï¼Œå…¶ä¸­<code>T</code>æ˜¯å…ƒç´ çš„ç±»å‹ï¼Œ<code>k</code>æ˜¯é•¿åº¦ï¼Œä¾‹å¦‚ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å›ºå®šé•¿åº¦ Array</span><br><span class="line">uint[8] array1;</span><br><span class="line">bytes1[5] array2;</span><br><span class="line">address[100] array3;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯å˜é•¿åº¦æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰ï¼šåœ¨å£°æ˜æ—¶ä¸æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚ç”¨<code>T[]</code>çš„æ ¼å¼å£°æ˜ï¼Œå…¶ä¸­<code>T</code>æ˜¯å…ƒç´ çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼ˆ<code>bytes</code>æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯æ•°ç»„ï¼Œä½†æ˜¯ä¸ç”¨åŠ <code>[]</code>ï¼‰ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å¯å˜é•¿åº¦ Array</span><br><span class="line">uint[] array4;</span><br><span class="line">bytes1[] array5;</span><br><span class="line">address[] array6;</span><br><span class="line">bytes array7;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºæ•°ç»„çš„è§„åˆ™"><a href="#åˆ›å»ºæ•°ç»„çš„è§„åˆ™" class="headerlink" title="åˆ›å»ºæ•°ç»„çš„è§„åˆ™"></a>åˆ›å»ºæ•°ç»„çš„è§„åˆ™</h4><p>åœ¨solidityé‡Œï¼Œåˆ›å»ºæ•°ç»„æœ‰ä¸€äº›è§„åˆ™ï¼š</p>
<ul>
<li>å¯¹äº<code>memory</code>ä¿®é¥°çš„<code>åŠ¨æ€æ•°ç»„</code>ï¼Œå¯ä»¥ç”¨<code>new</code>æ“ä½œç¬¦æ¥åˆ›å»ºï¼Œä½†æ˜¯<strong>å¿…é¡»å£°æ˜é•¿åº¦</strong>ï¼Œå¹¶ä¸”<strong>å£°æ˜åé•¿åº¦ä¸èƒ½æ”¹å˜</strong>ã€‚ä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// memoryåŠ¨æ€æ•°ç»„</span><br><span class="line">uint[] memory array8 = new uint[](5);</span><br><span class="line">bytes memory array9 = new bytes(9);</span><br></pre></td></tr></table></figure>

<ul>
<li>æ•°ç»„å­—é¢å¸¸æ•°(Array Literals)æ˜¯å†™ä½œè¡¨è¾¾å¼å½¢å¼çš„æ•°ç»„ï¼Œç”¨æ–¹æ‹¬å·åŒ…ç€æ¥åˆå§‹åŒ–arrayçš„ä¸€ç§æ–¹å¼ï¼Œå¹¶ä¸”é‡Œé¢æ¯ä¸€ä¸ªå…ƒç´ çš„typeæ˜¯ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡†çš„ï¼Œä¾‹å¦‚<code>[1,2,3]</code>é‡Œé¢æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯uint8ç±»å‹ï¼Œå› ä¸ºåœ¨solidityä¸­å¦‚æœä¸€ä¸ªå€¼æ²¡æœ‰æŒ‡å®štypeçš„è¯ï¼Œ<strong>é»˜è®¤å°±æ˜¯æœ€å°å•ä½çš„è¯¥type</strong>ï¼Œè¿™é‡Œintçš„é»˜è®¤æœ€å°å•ä½ç±»å‹å°±æ˜¯uint8ã€‚è€Œ<code>[uint(1),2,3]</code>é‡Œé¢çš„å…ƒç´ éƒ½æ˜¯uintç±»å‹ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å®šäº†æ˜¯uintç±»å‹äº†ï¼Œæˆ‘ä»¬éƒ½ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡†ã€‚ä¸‹é¢çš„åˆçº¦ä¸­ï¼Œå¯¹äºfå‡½æ•°é‡Œé¢çš„è°ƒç”¨ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æ˜¾å¼å¯¹ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡Œuintå¼ºè½¬çš„è¯ï¼Œæ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› ä¸ºå¦‚ä¸Šæ‰€è¿°æˆ‘ä»¬å…¶å®æ˜¯ä¼ å…¥äº†uint8ç±»å‹çš„arrayï¼Œå¯æ˜¯gå‡½æ•°éœ€è¦çš„å´æ˜¯uintç±»å‹çš„arrayï¼Œå°±ä¼šæŠ¥é”™äº†ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.16 &lt;0.9.0;</span><br><span class="line">contract C &#123;</span><br><span class="line">    function f() public pure &#123;</span><br><span class="line">        g([uint(1), 2, 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    function g(uint[3] memory) public pure &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœåˆ›å»ºçš„æ˜¯åŠ¨æ€æ•°ç»„ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªå…ƒç´ çš„èµ‹å€¼ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint[] memory x = new uint[](3);</span><br><span class="line">x[0] = 1;</span><br><span class="line">x[1] = 3;</span><br><span class="line">x[2] = 4;</span><br></pre></td></tr></table></figure>

<h4 id="æ•°ç»„æˆå‘˜"><a href="#æ•°ç»„æˆå‘˜" class="headerlink" title="æ•°ç»„æˆå‘˜"></a>æ•°ç»„æˆå‘˜</h4><ul>
<li><code>length</code>: æ•°ç»„æœ‰ä¸€ä¸ªåŒ…å«å…ƒç´ æ•°é‡çš„<code>length</code>æˆå‘˜ï¼Œ<code>memory</code>æ•°ç»„çš„é•¿åº¦åœ¨åˆ›å»ºåæ˜¯å›ºå®šçš„ã€‚</li>
<li><code>push()</code>: <code>åŠ¨æ€æ•°ç»„</code>å’Œ<code>bytes</code>æ‹¥æœ‰<code>push()</code>æˆå‘˜ï¼Œå¯ä»¥åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ª<code>0</code>å…ƒç´ ã€‚</li>
<li><code>push(x)</code>: <code>åŠ¨æ€æ•°ç»„</code>å’Œ<code>bytes</code>æ‹¥æœ‰<code>push(x)</code>æˆå‘˜ï¼Œå¯ä»¥åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ª<code>x</code>å…ƒç´ ã€‚</li>
<li><code>pop()</code>: <code>åŠ¨æ€æ•°ç»„</code>å’Œ<code>bytes</code>æ‹¥æœ‰<code>pop()</code>æˆå‘˜ï¼Œå¯ä»¥ç§»é™¤æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</li>
</ul>
<h3 id="ç»“æ„ä½“-struct"><a href="#ç»“æ„ä½“-struct" class="headerlink" title="ç»“æ„ä½“ struct"></a>ç»“æ„ä½“ struct</h3><p><code>Solidity</code>æ”¯æŒé€šè¿‡æ„é€ ç»“æ„ä½“çš„å½¢å¼å®šä¹‰æ–°çš„ç±»å‹ã€‚åˆ›å»ºç»“æ„ä½“çš„æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ç»“æ„ä½“</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student student; // åˆå§‹ä¸€ä¸ªstudentç»“æ„ä½“</span><br></pre></td></tr></table></figure>

<p>ç»™ç»“æ„ä½“èµ‹å€¼çš„ä¸¤ç§æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//  ç»™ç»“æ„ä½“èµ‹å€¼</span><br><span class="line">// æ–¹æ³•1:åœ¨å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªstorageçš„structå¼•ç”¨</span><br><span class="line">function initStudent1() external&#123;</span><br><span class="line">    Student storage _student = student; // assign a copy of student</span><br><span class="line">    _student.id = 11;</span><br><span class="line">    _student.score = 100;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> // æ–¹æ³•2:ç›´æ¥å¼•ç”¨çŠ¶æ€å˜é‡çš„struct</span><br><span class="line">function initStudent2() external&#123;</span><br><span class="line">    student.id = 1;</span><br><span class="line">    student.score = 80;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-æ˜ å°„ç±»å‹"><a href="#5-æ˜ å°„ç±»å‹" class="headerlink" title="5.æ˜ å°„ç±»å‹"></a>5.æ˜ å°„ç±»å‹</h2><p>å£°æ˜æ˜ å°„çš„æ ¼å¼ä¸º<code>mapping(_KeyType =&gt; _ValueType)</code>ï¼Œå…¶ä¸­<code>_KeyType</code>å’Œ<code>_ValueType</code>åˆ†åˆ«æ˜¯<code>Key</code>å’Œ<code>Value</code>çš„å˜é‡ç±»å‹ã€‚ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping(uint =&gt; address) public idToAddress; // idæ˜ å°„åˆ°åœ°å€</span><br><span class="line">mapping(address =&gt; address) public swapPair; // å¸å¯¹çš„æ˜ å°„ï¼Œåœ°å€åˆ°åœ°å€</span><br></pre></td></tr></table></figure>

<h3 id="æ˜ å°„çš„è§„åˆ™"><a href="#æ˜ å°„çš„è§„åˆ™" class="headerlink" title="æ˜ å°„çš„è§„åˆ™"></a>æ˜ å°„çš„è§„åˆ™</h3><ul>
<li><strong>è§„åˆ™1</strong>ï¼šæ˜ å°„çš„<code>_KeyType</code>åªèƒ½é€‰æ‹©<code>solidity</code>é»˜è®¤çš„ç±»å‹ï¼Œæ¯”å¦‚<code>uint</code>ï¼Œ<code>address</code>ç­‰ï¼Œä¸èƒ½ç”¨è‡ªå®šä¹‰çš„ç»“æ„ä½“ã€‚è€Œ<code>_ValueType</code>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>_KeyType</code>ä½¿ç”¨äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ç»“æ„ä½“ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ Struct</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line"> mapping(Student =&gt; uint) public testVar;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>è§„åˆ™2</strong>ï¼šæ˜ å°„çš„å­˜å‚¨ä½ç½®å¿…é¡»æ˜¯<code>storage</code>ï¼Œå› æ­¤å¯ä»¥ç”¨äºåˆçº¦çš„çŠ¶æ€å˜é‡ï¼Œå‡½æ•°ä¸­çš„<code>storage</code>å˜é‡ï¼Œå’Œlibraryå‡½æ•°çš„å‚æ•°ï¼ˆè§<a target="_blank" rel="noopener" href="https://github.com/ethereum/solidity/issues/4635">ä¾‹å­</a>ï¼‰ã€‚ä¸èƒ½ç”¨äº<code>public</code>å‡½æ•°çš„å‚æ•°æˆ–è¿”å›ç»“æœä¸­ï¼Œå› ä¸º<code>mapping</code>è®°å½•çš„æ˜¯ä¸€ç§å…³ç³» (key - value pair)ã€‚</li>
<li><strong>è§„åˆ™3</strong>ï¼šå¦‚æœæ˜ å°„å£°æ˜ä¸º<code>public</code>ï¼Œé‚£ä¹ˆ<code>solidity</code>ä¼šè‡ªåŠ¨ç»™ä½ åˆ›å»ºä¸€ä¸ª<code>getter</code>å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡<code>Key</code>æ¥æŸ¥è¯¢å¯¹åº”çš„<code>Value</code>ã€‚</li>
<li><strong>è§„åˆ™4</strong>ï¼šç»™æ˜ å°„æ–°å¢çš„é”®å€¼å¯¹çš„è¯­æ³•ä¸º<code>_Var[_Key] = _Value</code>ï¼Œå…¶ä¸­<code>_Var</code>æ˜¯æ˜ å°„å˜é‡åï¼Œ<code>_Key</code>å’Œ<code>_Value</code>å¯¹åº”æ–°å¢çš„é”®å€¼å¯¹ã€‚ä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function writeMap (uint _Key, address _Value) public&#123;</span><br><span class="line">    idToAddress[_Key] = _Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ˜ å°„çš„åŸç†"><a href="#æ˜ å°„çš„åŸç†" class="headerlink" title="æ˜ å°„çš„åŸç†"></a>æ˜ å°„çš„åŸç†</h3><ul>
<li><strong>åŸç†1</strong>: æ˜ å°„ä¸å‚¨å­˜ä»»ä½•é”®ï¼ˆ<code>Key</code>ï¼‰çš„èµ„è®¯ï¼Œä¹Ÿæ²¡æœ‰lengthçš„èµ„è®¯ã€‚</li>
<li><strong>åŸç†2</strong>: æ˜ å°„ä½¿ç”¨<code>keccak256(key)</code>å½“æˆoffsetå­˜å–valueã€‚</li>
<li><strong>åŸç†3</strong>: å› ä¸ºEthereumä¼šå®šä¹‰æ‰€æœ‰æœªä½¿ç”¨çš„ç©ºé—´ä¸º0ï¼Œæ‰€ä»¥æœªèµ‹å€¼ï¼ˆ<code>Value</code>ï¼‰çš„é”®ï¼ˆ<code>Key</code>ï¼‰åˆå§‹å€¼éƒ½æ˜¯0ã€‚</li>
</ul>
<h2 id="6-å˜é‡åˆå§‹å€¼"><a href="#6-å˜é‡åˆå§‹å€¼" class="headerlink" title="6.å˜é‡åˆå§‹å€¼"></a>6.å˜é‡åˆå§‹å€¼</h2><h3 id="å€¼ç±»å‹åˆå§‹å€¼"><a href="#å€¼ç±»å‹åˆå§‹å€¼" class="headerlink" title="å€¼ç±»å‹åˆå§‹å€¼"></a>å€¼ç±»å‹åˆå§‹å€¼</h3><ul>
<li><code>boolean</code>: <code>false</code></li>
<li><code>string</code>: <code>&quot;&quot;</code></li>
<li><code>int</code>: <code>0</code></li>
<li><code>uint</code>: <code>0</code></li>
<li><code>enum</code>: æšä¸¾ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li>
<li><code>address</code>: <code>0x0000000000000000000000000000000000000000</code> (æˆ– <code>address(0)</code>)</li>
<li><code>function</code><ul>
<li><code>internal</code>: ç©ºç™½æ–¹ç¨‹</li>
<li><code>external</code>: ç©ºç™½æ–¹ç¨‹</li>
</ul>
</li>
</ul>
<p>å¯ä»¥ç”¨<code>public</code>å˜é‡çš„<code>getter</code>å‡½æ•°éªŒè¯ä¸Šé¢å†™çš„åˆå§‹å€¼æ˜¯å¦æ­£ç¡®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">bool public _bool; // false</span><br><span class="line">string public _string; // &quot;&quot;</span><br><span class="line">int public _int; // 0</span><br><span class="line">uint public _uint; // 0</span><br><span class="line">address public _address; // 0x0000000000000000000000000000000000000000</span><br><span class="line"></span><br><span class="line">enum ActionSet &#123; Buy, Hold, Sell&#125;</span><br><span class="line">ActionSet public _enum; // ç¬¬ä¸€ä¸ªå…ƒç´  0</span><br><span class="line"></span><br><span class="line">function fi() internal&#123;&#125; // internalç©ºç™½æ–¹ç¨‹ </span><br><span class="line">function fe() external&#123;&#125; // externalç©ºç™½æ–¹ç¨‹ </span><br></pre></td></tr></table></figure>

<h3 id="å¼•ç”¨ç±»å‹åˆå§‹å€¼"><a href="#å¼•ç”¨ç±»å‹åˆå§‹å€¼" class="headerlink" title="å¼•ç”¨ç±»å‹åˆå§‹å€¼"></a>å¼•ç”¨ç±»å‹åˆå§‹å€¼</h3><ul>
<li>æ˜ å°„<code>mapping</code>: æ‰€æœ‰å…ƒç´ éƒ½ä¸ºå…¶é»˜è®¤å€¼çš„<code>mapping</code></li>
<li>ç»“æ„ä½“<code>struct</code>: æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„ç»“æ„ä½“</li>
<li>æ•°ç»„<code>array</code><ul>
<li>åŠ¨æ€æ•°ç»„: <code>[]</code></li>
<li>é™æ€æ•°ç»„ï¼ˆå®šé•¿ï¼‰: æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„é™æ€æ•°ç»„</li>
</ul>
</li>
</ul>
<p>å¯ä»¥ç”¨<code>public</code>å˜é‡çš„<code>getter</code>å‡½æ•°éªŒè¯ä¸Šé¢å†™çš„åˆå§‹å€¼æ˜¯å¦æ­£ç¡®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Reference Types</span><br><span class="line">uint[8] public _staticArray; // æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„é™æ€æ•°ç»„[0,0,0,0,0,0,0,0]</span><br><span class="line">uint[] public _dynamicArray; // `[]`</span><br><span class="line">mapping(uint =&gt; address) public _mapping; // æ‰€æœ‰å…ƒç´ éƒ½ä¸ºå…¶é»˜è®¤å€¼çš„mapping</span><br><span class="line">// æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„ç»“æ„ä½“ 0, 0</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line">Student public student;</span><br></pre></td></tr></table></figure>

<h3 id="deleteæ“ä½œç¬¦"><a href="#deleteæ“ä½œç¬¦" class="headerlink" title="deleteæ“ä½œç¬¦"></a><code>delete</code>æ“ä½œç¬¦</h3><p><code>delete a</code>ä¼šè®©å˜é‡<code>a</code>çš„å€¼å˜ä¸ºåˆå§‹å€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// deleteæ“ä½œç¬¦</span><br><span class="line">bool public _bool2 = true; </span><br><span class="line">function d() external &#123;</span><br><span class="line">    delete _bool2; // delete ä¼šè®©_bool2å˜ä¸ºé»˜è®¤å€¼ï¼Œfalse</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-å¸¸æ•°"><a href="#7-å¸¸æ•°" class="headerlink" title="7.å¸¸æ•°"></a>7.å¸¸æ•°</h2><p><code>solidity</code>å…¶ä¸­çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œ<code>constant</code>ï¼ˆå¸¸é‡ï¼‰å’Œ<code>immutable</code>ï¼ˆä¸å˜é‡ï¼‰ã€‚çŠ¶æ€å˜é‡å£°æ˜è¿™ä¸ªä¸¤ä¸ªå…³é”®å­—ä¹‹åï¼Œä¸èƒ½åœ¨åˆçº¦åæ›´æ”¹æ•°å€¼ï¼›å¹¶ä¸”è¿˜å¯ä»¥èŠ‚çœ<code>gas</code>ã€‚å¦å¤–ï¼Œ**åªæœ‰æ•°å€¼å˜é‡å¯ä»¥å£°æ˜<code>constant</code>å’Œ<code>immutable</code>ï¼›<code>string</code>å’Œ<code>bytes</code>å¯ä»¥å£°æ˜ä¸º<code>constant</code>ï¼Œä½†ä¸èƒ½ä¸º<code>immutable</code>**ã€‚</p>
<h3 id="constantå’Œimmutable"><a href="#constantå’Œimmutable" class="headerlink" title="constantå’Œimmutable"></a>constantå’Œimmutable</h3><h4 id="constant"><a href="#constant" class="headerlink" title="constant"></a>constant</h4><p><code>constant</code>å˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–ï¼Œä¹‹åå†ä¹Ÿä¸èƒ½æ”¹å˜ã€‚å°è¯•æ”¹å˜çš„è¯ï¼Œç¼–è¯‘ä¸é€šè¿‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// constantå˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">uint256 constant CONSTANT_NUM = 10;</span><br><span class="line">string constant CONSTANT_STRING = &quot;0xAA&quot;;</span><br><span class="line">bytes constant CONSTANT_BYTES = &quot;WTF&quot;;</span><br><span class="line">address constant CONSTANT_ADDRESS = 0x0000000000000000000000000000000000000000;</span><br></pre></td></tr></table></figure>

<h4 id="immutable"><a href="#immutable" class="headerlink" title="immutable"></a>immutable</h4><p><code>immutable</code>å˜é‡å¯ä»¥åœ¨å£°æ˜æ—¶æˆ–æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// immutableå˜é‡å¯ä»¥åœ¨constructoré‡Œåˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">uint256 public immutable IMMUTABLE_NUM = 9999999999;</span><br><span class="line">address public immutable IMMUTABLE_ADDRESS;</span><br><span class="line">uint256 public immutable IMMUTABLE_BLOCK;</span><br><span class="line">uint256 public immutable IMMUTABLE_TEST;</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡ä¾‹å¦‚<code>address(this)</code>ï¼Œ<code>block.number</code> ï¼Œæˆ–è€…è‡ªå®šä¹‰çš„å‡½æ•°ç»™<code>immutable</code>å˜é‡åˆå§‹åŒ–ã€‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†<code>test()</code>å‡½æ•°ç»™<code>IMMUTABLE_TEST</code>åˆå§‹åŒ–ä¸º<code>9</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// åˆ©ç”¨constructoråˆå§‹åŒ–immutableå˜é‡ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨</span><br><span class="line">constructor()&#123;</span><br><span class="line">    IMMUTABLE_ADDRESS = address(this);</span><br><span class="line">    IMMUTABLE_BLOCK = block.number;</span><br><span class="line">    IMMUTABLE_TEST = test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function test() public pure returns(uint256)&#123;</span><br><span class="line">    uint256 what = 9;</span><br><span class="line">    return(what);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-æ§åˆ¶æµ"><a href="#8-æ§åˆ¶æµ" class="headerlink" title="8.æ§åˆ¶æµ"></a>8.æ§åˆ¶æµ</h2><p><code>Solidity</code>çš„æ§åˆ¶æµä¸å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š</p>
<ol>
<li><code>if-else</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function ifElseTest(uint256 _number) public pure returns(bool)&#123;</span><br><span class="line">    if(_number == 0)&#123;</span><br><span class="line">    return(true);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    return(false);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>forå¾ªç¯</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function forLoopTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    for(uint i = 0; i &lt; 10; i++)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>whileå¾ªç¯</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function whileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    while(i &lt; 10)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><code>do-whileå¾ªç¯</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function doWhileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    do&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;while(i &lt; 10);</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><code>ä¸‰å…ƒè¿ç®—ç¬¦</code> ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯<code>solidity</code>ä¸­å”¯ä¸€ä¸€ä¸ªæ¥å—ä¸‰ä¸ªæ“ä½œæ•°çš„è¿ç®—ç¬¦ï¼Œè§„åˆ™<code>æ¡ä»¶? æ¡ä»¶ä¸ºçœŸçš„è¡¨è¾¾å¼:æ¡ä»¶ä¸ºå‡çš„è¡¨è¾¾å¼</code>ã€‚ æ­¤è¿ç®—ç¬¦ç»å¸¸ç”¨ä½œ if è¯­å¥çš„å¿«æ·æ–¹å¼ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ä¸‰å…ƒè¿ç®—ç¬¦ ternary/conditional operator</span><br><span class="line">function ternaryTest(uint256 x, uint256 y) public pure returns(uint256)&#123;</span><br><span class="line">    // return the max of x and y</span><br><span class="line">    return x &gt;= y ? x: y; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–è¿˜æœ‰<code>continue</code>ï¼ˆç«‹å³è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ï¼‰å’Œ<code>break</code>ï¼ˆè·³å‡ºå½“å‰å¾ªç¯ï¼‰å…³é”®å­—å¯ä»¥ä½¿ç”¨ã€‚</p>
<h3 id="ç”¨solidityå®ç°æ’å…¥æ’åº"><a href="#ç”¨solidityå®ç°æ’å…¥æ’åº" class="headerlink" title="ç”¨solidityå®ç°æ’å…¥æ’åº"></a>ç”¨<code>solidity</code>å®ç°æ’å…¥æ’åº</h3><h4 id="å†™åœ¨å‰é¢ï¼š90-ä»¥ä¸Šçš„äººç”¨solidityå†™æ’å…¥ç®—æ³•éƒ½ä¼šå‡ºé”™ã€‚"><a href="#å†™åœ¨å‰é¢ï¼š90-ä»¥ä¸Šçš„äººç”¨solidityå†™æ’å…¥ç®—æ³•éƒ½ä¼šå‡ºé”™ã€‚" class="headerlink" title="å†™åœ¨å‰é¢ï¼š90%ä»¥ä¸Šçš„äººç”¨solidityå†™æ’å…¥ç®—æ³•éƒ½ä¼šå‡ºé”™ã€‚"></a>å†™åœ¨å‰é¢ï¼š90%ä»¥ä¸Šçš„äººç”¨<code>solidity</code>å†™æ’å…¥ç®—æ³•éƒ½ä¼šå‡ºé”™ã€‚</h4><h4 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h4><p>æ’åºç®—æ³•è§£å†³çš„é—®é¢˜æ˜¯å°†æ— åºçš„ä¸€ç»„æ•°å­—ï¼Œä¾‹å¦‚<code>[2, 5, 3, 1]</code>ï¼Œä»å°åˆ°å¤§ä¾æ¬¡æ’åˆ—å¥½ã€‚æ’å…¥æ’åºï¼ˆ<code>InsertionSort</code>ï¼‰æ˜¯æœ€ç®€å•çš„ä¸€ç§æ’åºç®—æ³•ï¼Œä¹Ÿæ˜¯å¾ˆå¤šäººå­¦ä¹ çš„ç¬¬ä¸€ä¸ªç®—æ³•ã€‚å®ƒçš„æ€è·¯å¾ˆç®€ç­”ï¼Œä»å‰å¾€åï¼Œä¾æ¬¡å°†æ¯ä¸€ä¸ªæ•°å’Œæ’åœ¨ä»–å‰é¢çš„æ•°å­—æ¯”å¤§å°ï¼Œå¦‚æœæ¯”å‰é¢çš„æ•°å­—å°ï¼Œå°±äº’æ¢ä½ç½®ã€‚ç¤ºæ„å›¾ï¼š</p>
<p><img src="https://i.pinimg.com/originals/92/b0/34/92b034385c440e08bc8551c97df0a2e3.gif" alt="æ’å…¥æ’åº"></p>
<h5 id="pythonä»£ç "><a href="#pythonä»£ç " class="headerlink" title="pythonä»£ç "></a><code>python</code>ä»£ç </h5><p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹æ’å…¥æ’åºçš„pythonä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python program for implementation of Insertion Sort</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">insertionSort</span>(<span class="params">arr</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(arr)):</span><br><span class="line">        key = arr[i]</span><br><span class="line">        j = i-<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> j &gt;=<span class="number">0</span> <span class="keyword">and</span> key &lt; arr[j] :</span><br><span class="line">                arr[j+<span class="number">1</span>] = arr[j]</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">        arr[j+<span class="number">1</span>] = key</span><br></pre></td></tr></table></figure>

<h5 id="æ”¹å†™æˆsolidityåæœ‰BUGï¼"><a href="#æ”¹å†™æˆsolidityåæœ‰BUGï¼" class="headerlink" title="æ”¹å†™æˆsolidityåæœ‰BUGï¼"></a>æ”¹å†™æˆ<code>solidity</code>åæœ‰<code>BUG</code>ï¼</h5><p>ä¸€å…±8è¡Œ<code>python</code>ä»£ç å°±å¯ä»¥å®Œæˆæ’å…¥æ’åºï¼Œéå¸¸ç®€å•ã€‚é‚£ä¹ˆæˆ‘ä»¬å°†å®ƒæ”¹å†™æˆ<code>solidity</code>ä»£ç ï¼Œå°†å‡½æ•°ï¼Œå˜é‡ï¼Œå¾ªç¯ç­‰ç­‰éƒ½åšäº†ç›¸åº”çš„è½¬æ¢ï¼Œåªéœ€è¦9è¡Œä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// æ’å…¥æ’åº é”™è¯¯ç‰ˆ</span><br><span class="line">function insertionSortWrong(uint[] memory a) public pure returns(uint[] memory) &#123;</span><br><span class="line">    </span><br><span class="line">    for (uint i = 1;i &lt; a.length;i++)&#123;</span><br><span class="line">        uint temp = a[i];</span><br><span class="line">        uint j=i-1;</span><br><span class="line">        while( (j &gt;= 0) &amp;&amp; (temp &lt; a[j]))&#123;</span><br><span class="line">            a[j+1] = a[j];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j+1] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    return(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£æˆ‘ä»¬æŠŠæ”¹å¥½çš„æ”¾åˆ°<code>remix</code>ä¸Šå»è·‘ï¼Œè¾“å…¥<code>[2, 5, 3, 1]</code>ã€‚BOOMï¼æœ‰<code>bug</code>ï¼æ”¹äº†åŠå¤©ï¼Œæ²¡æ‰¾åˆ°<code>bug</code>åœ¨å“ªã€‚æˆ‘åˆå»<code>google</code>æœâ€solidity insertion sortâ€ï¼Œç„¶åå‘ç°ç½‘ä¸Šç”¨<code>solidity</code>å†™çš„æ’å…¥ç®—æ³•æ•™ç¨‹éƒ½æ˜¯é”™çš„ï¼Œæ¯”å¦‚ï¼š<a target="_blank" rel="noopener" href="https://medium.com/coinmonks/sorting-in-solidity-without-comparison-4eb47e04ff0d">Sorting in Solidity without Comparison</a></p>
<p>Remix decoded output å‡ºç°é”™è¯¯å†…å®¹ <img src="https://wtf.academy/assets/images/10-1-e9590da7aad6c176501b7fc5abe3372f.jpg" alt="10-1"></p>
<h5 id="æ­£ç¡®çš„solidityæ’å…¥æ’åº"><a href="#æ­£ç¡®çš„solidityæ’å…¥æ’åº" class="headerlink" title="æ­£ç¡®çš„solidityæ’å…¥æ’åº"></a>æ­£ç¡®çš„solidityæ’å…¥æ’åº</h5><p><code>solidity</code>ä¸­æœ€å¸¸ç”¨çš„å˜é‡ç±»å‹æ˜¯<code>uint</code>ï¼Œä¹Ÿå°±æ˜¯æ­£æ•´æ•°ï¼Œå–åˆ°è´Ÿå€¼çš„è¯ï¼Œä¼šæŠ¥<code>underflow</code>é”™è¯¯ã€‚è€Œ<strong>åœ¨æ’å…¥ç®—æ³•ä¸­ï¼Œå˜é‡<code>j</code>æœ‰å¯èƒ½ä¼šå–åˆ°<code>-1</code>ï¼Œå¼•èµ·æŠ¥é”™</strong>ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æŠŠ<code>j</code>åŠ 1ï¼Œè®©å®ƒæ— æ³•å–åˆ°è´Ÿå€¼ã€‚æ­£ç¡®ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// æ’å…¥æ’åº æ­£ç¡®ç‰ˆ</span><br><span class="line">function insertionSort(uint[] memory a) public pure returns(uint[] memory) &#123;</span><br><span class="line">    // note that uint can not take negative value</span><br><span class="line">    for (uint i = 1;i &lt; a.length;i++)&#123;</span><br><span class="line">        uint temp = a[i];</span><br><span class="line">        uint j=i;</span><br><span class="line">        while( (j &gt;= 1) &amp;&amp; (temp &lt; a[j-1]))&#123;</span><br><span class="line">            a[j] = a[j-1];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    return(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨"><a href="#9-æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨" class="headerlink" title="9.æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨"></a>9.æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨</h2><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p>æ„é€ å‡½æ•°ï¼ˆ<code>constructor</code>ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œæ¯ä¸ªåˆçº¦å¯ä»¥å®šä¹‰ä¸€ä¸ªï¼Œå¹¶<strong>åœ¨éƒ¨ç½²åˆçº¦çš„æ—¶å€™è‡ªåŠ¨è¿è¡Œä¸€æ¬¡</strong>ã€‚å®ƒå¯ä»¥ç”¨æ¥åˆå§‹åŒ–åˆçº¦çš„ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚åˆå§‹åŒ–åˆçº¦çš„<code>owner</code>åœ°å€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">address owner; // å®šä¹‰ownerå˜é‡</span><br><span class="line"></span><br><span class="line">// æ„é€ å‡½æ•°</span><br><span class="line">constructor() &#123;</span><br><span class="line">   owner = msg.sender; // åœ¨éƒ¨ç½²åˆçº¦çš„æ—¶å€™ï¼Œå°†ownerè®¾ç½®ä¸ºéƒ¨ç½²è€…çš„åœ°å€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong>âš ï¸ï¼šæ„é€ å‡½æ•°åœ¨ä¸åŒçš„solidityç‰ˆæœ¬ä¸­çš„è¯­æ³•å¹¶ä¸ä¸€è‡´ï¼Œåœ¨Solidity 0.4.22ä¹‹å‰ï¼Œæ„é€ å‡½æ•°ä¸ä½¿ç”¨ <code>constructor</code> è€Œæ˜¯ä½¿ç”¨ä¸åˆçº¦ååŒåçš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°è€Œä½¿ç”¨ï¼Œç”±äºè¿™ç§æ—§å†™æ³•å®¹æ˜“ä½¿å¼€å‘è€…åœ¨ä¹¦å†™æ—¶å‘ç”Ÿç–æ¼ï¼ˆä¾‹å¦‚åˆçº¦åå« <code>Parents</code>ï¼Œæ„é€ å‡½æ•°åå†™æˆ <code>parents</code>ï¼‰ï¼Œä½¿å¾—æ„é€ å‡½æ•°å˜æˆæ™®é€šå‡½æ•°ï¼Œå¼•å‘æ¼æ´ï¼Œæ‰€ä»¥0.4.22ç‰ˆæœ¬åŠä¹‹åï¼Œé‡‡ç”¨äº†å…¨æ–°çš„ <code>constructor</code> å†™æ³•ã€‚</p>
<p>æ„é€ å‡½æ•°çš„æ—§å†™æ³•ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity =0.4.21;</span><br><span class="line">contract Parents &#123;</span><br><span class="line">    // ä¸åˆçº¦åParentsåŒåçš„å‡½æ•°å°±æ˜¯æ„é€ å‡½æ•°</span><br><span class="line">    function Parents () public &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®é¥°å™¨"><a href="#ä¿®é¥°å™¨" class="headerlink" title="ä¿®é¥°å™¨"></a>ä¿®é¥°å™¨</h3><p>ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰æ˜¯<code>solidity</code>ç‰¹æœ‰çš„è¯­æ³•ï¼Œç±»ä¼¼äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„<code>decorator</code>ï¼Œå£°æ˜å‡½æ•°æ‹¥æœ‰çš„ç‰¹æ€§ï¼Œå¹¶å‡å°‘ä»£ç å†—ä½™ã€‚å®ƒå°±åƒé’¢é“ä¾ çš„æ™ºèƒ½ç›”ç”²ï¼Œç©¿ä¸Šå®ƒçš„å‡½æ•°ä¼šå¸¦æœ‰æŸäº›ç‰¹å®šçš„è¡Œä¸ºã€‚<code>modifier</code>çš„<strong>ä¸»è¦ä½¿ç”¨åœºæ™¯æ˜¯è¿è¡Œå‡½æ•°å‰çš„æ£€æŸ¥</strong>ï¼Œä¾‹å¦‚åœ°å€ï¼Œå˜é‡ï¼Œä½™é¢ç­‰ã€‚</p>
<p>æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªå«åšonlyOwnerçš„modifierï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰modifier</span><br><span class="line">modifier onlyOwner &#123;</span><br><span class="line">   require(msg.sender == owner); // æ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦ä¸ºowneråœ°å€</span><br><span class="line">   _; // å¦‚æœæ˜¯çš„è¯ï¼Œç»§ç»­è¿è¡Œå‡½æ•°ä¸»ä½“ï¼›å¦åˆ™æŠ¥é”™å¹¶revertäº¤æ˜“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£æœ‰<code>onlyOwner</code>ä¿®é¥°ç¬¦çš„å‡½æ•°åªèƒ½è¢«<code>owner</code>åœ°å€è°ƒç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">   owner = _newOwner; // åªæœ‰owneråœ°å€è¿è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå¹¶æ”¹å˜owner</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>changeOwner</code>å‡½æ•°ï¼Œè¿è¡Œä»–å¯ä»¥æ”¹å˜åˆçº¦çš„<code>owner</code>ï¼Œä½†æ˜¯ç”±äº<code>onlyOwner</code>ä¿®é¥°ç¬¦çš„å­˜åœ¨ï¼Œåªæœ‰åŸå…ˆçš„<code>owner</code>å¯ä»¥è°ƒç”¨ï¼Œåˆ«äººè°ƒç”¨å°±ä¼šæŠ¥é”™ã€‚è¿™ä¹Ÿæ˜¯<strong>æœ€å¸¸ç”¨çš„æ§åˆ¶æ™ºèƒ½åˆçº¦æƒé™çš„æ–¹æ³•</strong>ã€‚</p>
<h2 id="10-äº‹ä»¶"><a href="#10-äº‹ä»¶" class="headerlink" title="10.äº‹ä»¶"></a>10.äº‹ä»¶</h2><p><code>Solidity</code>ä¸­çš„äº‹ä»¶ï¼ˆ<code>event</code>ï¼‰æ˜¯<code>EVM</code>ä¸Šæ—¥å¿—çš„æŠ½è±¡ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>å“åº”ï¼šåº”ç”¨ç¨‹åºï¼ˆ<a target="_blank" rel="noopener" href="https://learnblockchain.cn/docs/ethers.js/api-contract.html#id18"><code>ether.js</code></a>ï¼‰å¯ä»¥é€šè¿‡<code>RPC</code>æ¥å£è®¢é˜…å’Œç›‘å¬è¿™äº›äº‹ä»¶ï¼Œå¹¶åœ¨å‰ç«¯åšå“åº”ã€‚</li>
<li>ç»æµï¼šäº‹ä»¶æ˜¯<code>EVM</code>ä¸Šæ¯”è¾ƒç»æµçš„å­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼Œæ¯ä¸ªå¤§æ¦‚æ¶ˆè€—2,000 <code>gas</code>ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼Œé“¾ä¸Šå­˜å‚¨ä¸€ä¸ªæ–°å˜é‡è‡³å°‘éœ€è¦20,000 <code>gas</code>ã€‚</li>
</ul>
<h3 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><p>äº‹ä»¶çš„å£°æ˜ç”±<code>event</code>å…³é”®å­—å¼€å¤´ï¼Œç„¶åè·Ÿäº‹ä»¶åç§°ï¼Œæ‹¬å·é‡Œé¢å†™å¥½äº‹ä»¶éœ€è¦è®°å½•çš„å˜é‡ç±»å‹å’Œå˜é‡åã€‚ä»¥<code>ERC20</code>ä»£å¸åˆçº¦çš„<code>Transfer</code>äº‹ä»¶ä¸ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event Transfer(address indexed from, address indexed to, uint256 value);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Transfer</code>äº‹ä»¶å…±è®°å½•äº†3ä¸ªå˜é‡<code>from</code>ï¼Œ<code>to</code>å’Œ<code>value</code>ï¼Œåˆ†åˆ«å¯¹åº”ä»£å¸çš„è½¬è´¦åœ°å€ï¼Œæ¥æ”¶åœ°å€å’Œè½¬è´¦æ•°é‡ã€‚</p>
<p>åŒæ—¶<code>from</code>å’Œ<code>to</code>å‰é¢å¸¦ç€<code>indexed</code>å…³é”®å­—ï¼Œ<strong>æ¯ä¸ª<code>indexed</code>æ ‡è®°çš„å˜é‡å¯ä»¥ç†è§£ä¸ºæ£€ç´¢äº‹ä»¶çš„ç´¢å¼•â€œé”®â€</strong>ï¼Œåœ¨ä»¥å¤ªåŠä¸Šå•ç‹¬ä½œä¸ºä¸€ä¸ª<code>topic</code>è¿›è¡Œå­˜å‚¨å’Œç´¢å¼•ï¼Œç¨‹åºå¯ä»¥è½»æ¾çš„ç­›é€‰å‡ºç‰¹å®šè½¬è´¦åœ°å€å’Œæ¥æ”¶åœ°å€çš„è½¬è´¦äº‹ä»¶ã€‚<strong>æ¯ä¸ªäº‹ä»¶æœ€å¤šæœ‰3ä¸ªå¸¦<code>indexed</code>çš„å˜é‡</strong>ã€‚æ¯ä¸ª <code>indexed</code> å˜é‡çš„å¤§å°ä¸ºå›ºå®šçš„256æ¯”ç‰¹ã€‚äº‹ä»¶çš„å“ˆå¸Œä»¥åŠè¿™ä¸‰ä¸ªå¸¦<code>indexed</code>çš„å˜é‡åœ¨<code>EVM</code>æ—¥å¿—ä¸­é€šå¸¸è¢«å­˜å‚¨ä¸º<code>topic</code>ã€‚å…¶ä¸­<code>topic[0]</code>æ˜¯æ­¤äº‹ä»¶çš„<code>keccak256</code>å“ˆå¸Œï¼Œ<code>topic[1]</code>åˆ°<code>topic[3]</code>å­˜å‚¨äº†å¸¦<code>indexed</code>å˜é‡çš„<code>keccak256</code>å“ˆå¸Œã€‚</p>
<p><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/image-20221014092120084.png" alt="image-20221014092120084"></p>
<p><code>value</code> ä¸å¸¦ <code>indexed</code> å…³é”®å­—ï¼Œä¼šå­˜å‚¨åœ¨äº‹ä»¶çš„ <code>data</code> éƒ¨åˆ†ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºäº‹ä»¶çš„â€œå€¼â€ã€‚<code>data</code> éƒ¨åˆ†çš„å˜é‡ä¸èƒ½è¢«ç›´æ¥æ£€ç´¢ï¼Œä½†å¯ä»¥å­˜å‚¨ä»»æ„å¤§å°çš„æ•°æ®ã€‚å› æ­¤ä¸€èˆ¬ <code>data</code> éƒ¨åˆ†å¯ä»¥ç”¨æ¥å­˜å‚¨å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚æ•°ç»„å’Œå­—ç¬¦ä¸²ç­‰ç­‰ï¼Œå› ä¸ºè¿™äº›æ•°æ®è¶…è¿‡äº†256æ¯”ç‰¹ï¼Œå³ä½¿å­˜å‚¨åœ¨äº‹ä»¶çš„ <code>topic</code> éƒ¨åˆ†ä¸­ï¼Œä¹Ÿæ˜¯ä»¥å“ˆå¸Œçš„æ–¹å¼å­˜å‚¨ã€‚å¦å¤–ï¼Œ<code>data</code> éƒ¨åˆ†çš„å˜é‡åœ¨å­˜å‚¨ä¸Šæ¶ˆè€—çš„gasç›¸æ¯”äº <code>topic</code> æ›´å°‘ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°é‡Œé‡Šæ”¾äº‹ä»¶ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæ¯æ¬¡ç”¨<code>_transfer()</code>å‡½æ•°è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡Šæ”¾<code>Transfer</code>äº‹ä»¶ï¼Œå¹¶è®°å½•ç›¸åº”çš„å˜é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰_transferå‡½æ•°ï¼Œæ‰§è¡Œè½¬è´¦é€»è¾‘</span><br><span class="line">function _transfer(</span><br><span class="line">    address from,</span><br><span class="line">    address to,</span><br><span class="line">    uint256 amount</span><br><span class="line">) external &#123;</span><br><span class="line"></span><br><span class="line">    _balances[from] = 10000000; // ç»™è½¬è´¦åœ°å€ä¸€äº›åˆå§‹ä»£å¸</span><br><span class="line"></span><br><span class="line">    _balances[from] -=  amount; // fromåœ°å€å‡å»è½¬è´¦æ•°é‡</span><br><span class="line">    _balances[to] += amount; // toåœ°å€åŠ ä¸Šè½¬è´¦æ•°é‡</span><br><span class="line"></span><br><span class="line">    // é‡Šæ”¾äº‹ä»¶</span><br><span class="line">    emit Transfer(from, to, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-ç»§æ‰¿"><a href="#11-ç»§æ‰¿" class="headerlink" title="11.ç»§æ‰¿"></a>11.ç»§æ‰¿</h2><h3 id="è§„åˆ™-1"><a href="#è§„åˆ™-1" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h3><ul>
<li><code>virtual</code>: çˆ¶åˆçº¦ä¸­çš„å‡½æ•°ï¼Œå¦‚æœå¸Œæœ›å­åˆçº¦é‡å†™ï¼Œéœ€è¦åŠ ä¸Š<code>virtual</code>å…³é”®å­—ã€‚</li>
<li><code>override</code>ï¼šå­åˆçº¦é‡å†™äº†çˆ¶åˆçº¦ä¸­çš„å‡½æ•°ï¼Œéœ€è¦åŠ ä¸Š<code>override</code>å…³é”®å­—ã€‚</li>
</ul>
<h3 id="ç®€å•ç»§æ‰¿"><a href="#ç®€å•ç»§æ‰¿" class="headerlink" title="ç®€å•ç»§æ‰¿"></a>ç®€å•ç»§æ‰¿</h3><p>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç®€å•çš„çˆ·çˆ·åˆçº¦<code>Yeye</code>ï¼Œé‡Œé¢åŒ…å«1ä¸ª<code>Log</code>äº‹ä»¶å’Œ3ä¸ª<code>function</code>: <code>hip()</code>, <code>pop()</code>, <code>yeye()</code>ï¼Œè¾“å‡ºéƒ½æ˜¯â€Yeyeâ€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), man()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªçˆ¸çˆ¸åˆçº¦<code>Baba</code>ï¼Œè®©ä»–ç»§æ‰¿<code>Yeye</code>åˆçº¦ï¼Œè¯­æ³•å°±æ˜¯<code>contract Baba is Yeye</code>ï¼Œéå¸¸ç›´è§‚ã€‚åœ¨<code>Baba</code>åˆçº¦é‡Œï¼Œæˆ‘ä»¬é‡å†™ä¸€ä¸‹<code>hip()</code>å’Œ<code>pop()</code>è¿™ä¸¤ä¸ªå‡½æ•°ï¼ŒåŠ ä¸Š<code>override</code>å…³é”®å­—ï¼Œå¹¶å°†ä»–ä»¬çš„è¾“å‡ºæ”¹ä¸º<code>â€Babaâ€</code>ï¼›å¹¶ä¸”åŠ ä¸€ä¸ªæ–°çš„å‡½æ•°<code>baba</code>ï¼Œè¾“å‡ºä¹Ÿæ˜¯<code>â€Babaâ€</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºæ”¹ä¸ºBabaã€‚</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éƒ¨ç½²åˆçº¦ï¼Œå¯ä»¥çœ‹åˆ°<code>Baba</code>åˆçº¦é‡Œæœ‰4ä¸ªå‡½æ•°ï¼Œå…¶ä¸­<code>hip()</code>å’Œ<code>pop()</code>çš„è¾“å‡ºè¢«æˆåŠŸæ”¹å†™æˆ<code>â€Babaâ€</code>ï¼Œè€Œç»§æ‰¿æ¥çš„<code>yeye()</code>çš„è¾“å‡ºä»ç„¶æ˜¯<code>â€Yeyeâ€</code>ã€‚</p>
<h3 id="å¤šé‡ç»§æ‰¿"><a href="#å¤šé‡ç»§æ‰¿" class="headerlink" title="å¤šé‡ç»§æ‰¿"></a>å¤šé‡ç»§æ‰¿</h3><p><code>solidity</code>çš„åˆçº¦å¯ä»¥ç»§æ‰¿å¤šä¸ªåˆçº¦ã€‚è§„åˆ™ï¼š</p>
<p>ç»§æ‰¿æ—¶è¦æŒ‰è¾ˆåˆ†æœ€é«˜åˆ°æœ€ä½çš„é¡ºåºæ’ã€‚æ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ª<code>Erzi</code>åˆçº¦ï¼Œç»§æ‰¿<code>Yeye</code>åˆçº¦å’Œ<code>Baba</code>åˆçº¦ï¼Œé‚£ä¹ˆå°±è¦å†™æˆ<code>contract Erzi is Yeye, Baba</code>ï¼Œè€Œä¸èƒ½å†™æˆ<code>contract Erzi is Baba, Yeye</code>ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚ å¦‚æœæŸä¸€ä¸ªå‡½æ•°åœ¨å¤šä¸ªç»§æ‰¿çš„åˆçº¦é‡Œéƒ½å­˜åœ¨ï¼Œæ¯”å¦‚ä¾‹å­ä¸­çš„<code>hip()</code>å’Œ<code>pop()</code>ï¼Œåœ¨å­åˆçº¦é‡Œå¿…é¡»é‡å†™ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚ é‡å†™åœ¨å¤šä¸ªçˆ¶åˆçº¦ä¸­éƒ½é‡åçš„å‡½æ•°æ—¶ï¼Œ<code>override</code>å…³é”®å­—åé¢è¦åŠ ä¸Šæ‰€æœ‰çˆ¶åˆçº¦åå­—ï¼Œä¾‹å¦‚<code>override(Yeye, Baba)</code>ã€‚ ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contract Erzi is Yeye, Baba&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºå€¼ä¸ºErziã€‚</span><br><span class="line">    function hip() public virtual override(Yeye, Baba)&#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override(Yeye, Baba) &#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Erzi</code>åˆçº¦é‡Œé¢é‡å†™äº†<code>hip()</code>å’Œ<code>pop()</code>ä¸¤ä¸ªå‡½æ•°ï¼Œå°†è¾“å‡ºæ”¹ä¸º<code>â€Erziâ€</code>ï¼Œå¹¶ä¸”è¿˜åˆ†åˆ«ä»<code>Yeye</code>å’Œ<code>Baba</code>åˆçº¦ç»§æ‰¿äº†<code>yeye()</code>å’Œ<code>baba()</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p>
<h3 id="ä¿®é¥°å™¨çš„ç»§æ‰¿"><a href="#ä¿®é¥°å™¨çš„ç»§æ‰¿" class="headerlink" title="ä¿®é¥°å™¨çš„ç»§æ‰¿"></a>ä¿®é¥°å™¨çš„ç»§æ‰¿</h3><p><code>Solidity</code>ä¸­çš„ä¿®é¥°å™¨ï¼ˆ<code>Modifier</code>ï¼‰åŒæ ·å¯ä»¥ç»§æ‰¿ï¼Œç”¨æ³•ä¸å‡½æ•°ç»§æ‰¿ç±»ä¼¼ï¼Œåœ¨ç›¸åº”çš„åœ°æ–¹åŠ <code>virtual</code>å’Œ<code>override</code>å…³é”®å­—å³å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">contract Base1 &#123;</span><br><span class="line">    modifier exactDividedBy2And3(uint _a) virtual &#123;</span><br><span class="line">        require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Identifier is Base1 &#123;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼ï¼Œä½†æ˜¯ä¼ å…¥çš„å‚æ•°å¿…é¡»æ˜¯2å’Œ3çš„å€æ•°</span><br><span class="line">    function getExactDividedBy2And3(uint _dividend) public exactDividedBy2And3(_dividend) pure returns(uint, uint) &#123;</span><br><span class="line">        return getExactDividedBy2And3WithoutModifier(_dividend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼</span><br><span class="line">    function getExactDividedBy2And3WithoutModifier(uint _dividend) public pure returns(uint, uint)&#123;</span><br><span class="line">        uint div2 = _dividend / 2;</span><br><span class="line">        uint div3 = _dividend / 3;</span><br><span class="line">        return (div2, div3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Identifier</code>åˆçº¦å¯ä»¥ç›´æ¥åœ¨ä»£ç ä¸­ä½¿ç”¨çˆ¶åˆçº¦ä¸­çš„<code>exactDividedBy2And3</code>ä¿®é¥°å™¨ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨<code>override</code>å…³é”®å­—é‡å†™ä¿®é¥°å™¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">modifier exactDividedBy2And3(uint _a) override &#123;</span><br><span class="line">    _;</span><br><span class="line">    require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>æ„é€ å‡½æ•°çš„ç»§æ‰¿</h3><p>å­åˆçº¦æœ‰ä¸¤ç§æ–¹æ³•ç»§æ‰¿çˆ¶åˆçº¦çš„æ„é€ å‡½æ•°ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œçˆ¶åˆçº¦<code>A</code>é‡Œé¢æœ‰ä¸€ä¸ªçŠ¶æ€å˜é‡<code>a</code>ï¼Œå¹¶ç”±æ„é€ å‡½æ•°çš„å‚æ•°æ¥ç¡®å®šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ„é€ å‡½æ•°çš„ç»§æ‰¿</span><br><span class="line">abstract contract A &#123;</span><br><span class="line">    uint public a;</span><br><span class="line"></span><br><span class="line">    constructor(uint _a) &#123;</span><br><span class="line">        a = _a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>åœ¨ç»§æ‰¿æ—¶å£°æ˜çˆ¶æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>contract B is A(1)</code></li>
<li>åœ¨å­åˆçº¦çš„æ„é€ å‡½æ•°ä¸­å£°æ˜æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract C is A &#123;</span><br><span class="line">    constructor(uint _c) A(_c * _c) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°"><a href="#è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°" class="headerlink" title="è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°"></a>è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°</h3><p>å­åˆçº¦æœ‰ä¸¤ç§æ–¹å¼è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨å’Œåˆ©ç”¨<code>super</code>å…³é”®å­—ã€‚</p>
<ol>
<li>ç›´æ¥è°ƒç”¨ï¼šå­åˆçº¦å¯ä»¥ç›´æ¥ç”¨<code>çˆ¶åˆçº¦å.å‡½æ•°å()</code>çš„æ–¹å¼æ¥è°ƒç”¨çˆ¶åˆçº¦å‡½æ•°ï¼Œä¾‹å¦‚<code>Yeye.pop()</code>ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callParent() public&#123;</span><br><span class="line">    Yeye.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>super</code>å…³é”®å­—ï¼šå­åˆçº¦å¯ä»¥åˆ©ç”¨<code>super.å‡½æ•°å()</code>æ¥è°ƒç”¨æœ€è¿‘çš„çˆ¶åˆçº¦å‡½æ•°ã€‚<code>solidity</code>ç»§æ‰¿å…³ç³»æŒ‰å£°æ˜æ—¶<strong>ä»å³åˆ°å·¦çš„é¡ºåº</strong>æ˜¯ï¼š<code>contract Erzi is Yeye, Baba</code>ï¼Œé‚£ä¹ˆ<code>Baba</code>æ˜¯æœ€è¿‘çš„çˆ¶åˆçº¦ï¼Œ<code>super.pop()</code>å°†è°ƒç”¨<code>Baba.pop()</code>è€Œä¸æ˜¯<code>Yeye.pop()</code>ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callParentSuper() public&#123;</span><br><span class="line">    // å°†è°ƒç”¨æœ€è¿‘çš„çˆ¶åˆçº¦å‡½æ•°ï¼ŒBaba.pop()</span><br><span class="line">    super.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-æŠ½è±¡åˆçº¦å’Œæ¥å£"><a href="#12-æŠ½è±¡åˆçº¦å’Œæ¥å£" class="headerlink" title="12.æŠ½è±¡åˆçº¦å’Œæ¥å£"></a>12.æŠ½è±¡åˆçº¦å’Œæ¥å£</h2><h3 id="æŠ½è±¡åˆçº¦"><a href="#æŠ½è±¡åˆçº¦" class="headerlink" title="æŠ½è±¡åˆçº¦"></a>æŠ½è±¡åˆçº¦</h3><p>å¦‚æœä¸€ä¸ªæ™ºèƒ½åˆçº¦é‡Œè‡³å°‘æœ‰ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°ï¼Œå³æŸä¸ªå‡½æ•°ç¼ºå°‘ä¸»ä½“<code>&#123;&#125;</code>ä¸­çš„å†…å®¹ï¼Œåˆ™å¿…é¡»å°†è¯¥åˆçº¦æ ‡ä¸º<code>abstract</code>ï¼Œä¸ç„¶ç¼–è¯‘ä¼šæŠ¥é”™ï¼›å¦å¤–ï¼Œæœªå®ç°çš„å‡½æ•°éœ€è¦åŠ <code>virtual</code>ï¼Œä»¥ä¾¿å­åˆçº¦é‡å†™ã€‚æ‹¿æˆ‘ä»¬ä¹‹å‰çš„<a target="_blank" rel="noopener" href="https://github.com/AmazingAng/WTFSolidity/tree/main/07_InsertionSort">æ’å…¥æ’åºåˆçº¦</a>ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬è¿˜æ²¡æƒ³å¥½å…·ä½“æ€ä¹ˆå®ç°æ’å…¥æ’åºå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠåˆçº¦æ ‡ä¸º<code>abstract</code>ï¼Œä¹‹åè®©åˆ«äººè¡¥å†™ä¸Šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abstract contract InsertionSort&#123;</span><br><span class="line">    function insertionSort(uint[] memory a) public pure virtual returns(uint[] memory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p>æ¥å£ç±»ä¼¼äºæŠ½è±¡åˆçº¦ï¼Œä½†å®ƒä¸å®ç°ä»»ä½•åŠŸèƒ½ã€‚æ¥å£çš„è§„åˆ™ï¼š</p>
<ol>
<li>ä¸èƒ½åŒ…å«çŠ¶æ€å˜é‡</li>
<li>ä¸èƒ½åŒ…å«æ„é€ å‡½æ•°</li>
<li>ä¸èƒ½ç»§æ‰¿é™¤æ¥å£å¤–çš„å…¶ä»–åˆçº¦</li>
<li>æ‰€æœ‰å‡½æ•°éƒ½å¿…é¡»æ˜¯externalä¸”ä¸èƒ½æœ‰å‡½æ•°ä½“</li>
<li>ç»§æ‰¿æ¥å£çš„åˆçº¦å¿…é¡»å®ç°æ¥å£å®šä¹‰çš„æ‰€æœ‰åŠŸèƒ½</li>
</ol>
<p>è™½ç„¶æ¥å£ä¸å®ç°ä»»ä½•åŠŸèƒ½ï¼Œä½†å®ƒéå¸¸é‡è¦ã€‚æ¥å£æ˜¯æ™ºèƒ½åˆçº¦çš„éª¨æ¶ï¼Œå®šä¹‰äº†åˆçº¦çš„åŠŸèƒ½ä»¥åŠå¦‚ä½•è§¦å‘å®ƒä»¬ï¼šå¦‚æœæ™ºèƒ½åˆçº¦å®ç°äº†æŸç§æ¥å£ï¼ˆæ¯”å¦‚<code>ERC20</code>æˆ–<code>ERC721</code>ï¼‰ï¼Œå…¶ä»–Dappså’Œæ™ºèƒ½åˆçº¦å°±çŸ¥é“å¦‚ä½•ä¸å®ƒäº¤äº’ã€‚å› ä¸ºæ¥å£æä¾›äº†ä¸¤ä¸ªé‡è¦çš„ä¿¡æ¯ï¼š</p>
<ol>
<li>åˆçº¦é‡Œæ¯ä¸ªå‡½æ•°çš„<code>bytes4</code>é€‰æ‹©å™¨ï¼Œä»¥åŠåŸºäºå®ƒä»¬çš„å‡½æ•°ç­¾å<code>å‡½æ•°å(æ¯ä¸ªå‚æ•°ç±»å‹ï¼‰</code>ã€‚</li>
<li>æ¥å£idï¼ˆæ›´å¤šä¿¡æ¯è§<a target="_blank" rel="noopener" href="https://eips.ethereum.org/EIPS/eip-165">EIP165</a>ï¼‰</li>
</ol>
<p>å¦å¤–ï¼Œæ¥å£ä¸åˆçº¦<code>ABI</code>ï¼ˆApplication Binary Interfaceï¼‰ç­‰ä»·ï¼Œå¯ä»¥ç›¸äº’è½¬æ¢ï¼šç¼–è¯‘æ¥å£å¯ä»¥å¾—åˆ°åˆçº¦çš„<code>ABI</code>ï¼Œåˆ©ç”¨<a target="_blank" rel="noopener" href="https://gnidan.github.io/abi-to-sol/">abi-to-solå·¥å…·</a>ä¹Ÿå¯ä»¥å°†<code>ABI json</code>æ–‡ä»¶è½¬æ¢ä¸º<code>æ¥å£sol</code>æ–‡ä»¶ã€‚</p>
<h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</h4><p>å¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåˆçº¦å®ç°äº†<code>IERC721</code>æ¥å£ï¼Œæˆ‘ä»¬<strong>ä¸éœ€è¦çŸ¥é“å®ƒå…·ä½“ä»£ç å®ç°</strong>ï¼Œå°±å¯ä»¥ä¸å®ƒäº¤äº’ã€‚</p>
<p>æ— èŠçŒ¿<code>BAYC</code>å±äº<code>ERC721</code>ä»£å¸ï¼Œå®ç°äº†<code>IERC721</code>æ¥å£çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“å®ƒçš„æºä»£ç ï¼Œåªéœ€çŸ¥é“å®ƒçš„åˆçº¦åœ°å€ï¼Œç”¨<code>IERC721</code>æ¥å£å°±å¯ä»¥ä¸å®ƒäº¤äº’ï¼Œæ¯”å¦‚ç”¨<code>balanceOf()</code>æ¥æŸ¥è¯¢æŸä¸ªåœ°å€çš„<code>BAYC</code>ä½™é¢ï¼Œç”¨<code>safeTransferFrom()</code>æ¥è½¬è´¦<code>BAYC</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract interactBAYC &#123;</span><br><span class="line">    // åˆ©ç”¨BAYCåœ°å€åˆ›å»ºæ¥å£åˆçº¦å˜é‡ï¼ˆETHä¸»ç½‘ï¼‰</span><br><span class="line">    IERC721 BAYC = IERC721(0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D);</span><br><span class="line"></span><br><span class="line">    // é€šè¿‡æ¥å£è°ƒç”¨BAYCçš„balanceOf()æŸ¥è¯¢æŒä»“é‡</span><br><span class="line">    function balanceOfBAYC(address owner) external view returns (uint256 balance)&#123;</span><br><span class="line">        return BAYC.balanceOf(owner);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // é€šè¿‡æ¥å£è°ƒç”¨BAYCçš„safeTransferFrom()å®‰å…¨è½¬è´¦</span><br><span class="line">    function safeTransferFromBAYC(address from, address to, uint256 tokenId) external&#123;</span><br><span class="line">        BAYC.safeTransferFrom(from, to, tokenId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-å¼‚å¸¸"><a href="#13-å¼‚å¸¸" class="headerlink" title="13.å¼‚å¸¸"></a>13.å¼‚å¸¸</h2><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p><code>error</code>æ˜¯<code>solidity 0.8ç‰ˆæœ¬</code>æ–°åŠ çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¸”é«˜æ•ˆï¼ˆçœ<code>gas</code>ï¼‰åœ°å‘ç”¨æˆ·è§£é‡Šæ“ä½œå¤±è´¥çš„åŸå› ã€‚äººä»¬å¯ä»¥åœ¨<code>contract</code>ä¹‹å¤–å®šä¹‰å¼‚å¸¸ã€‚ä¸”erroræ˜¯å¯ä»¥æºå¸¦å‚æ•°çš„ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>TransferNotOwner</code>å¼‚å¸¸ï¼Œå½“ç”¨æˆ·ä¸æ˜¯ä»£å¸<code>owner</code>çš„æ—¶å€™å°è¯•è½¬è´¦ï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TransferNotOwner(); // è‡ªå®šä¹‰error</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œå½“ä¸­ï¼Œ<code>error</code>å¿…é¡»æ­é…<code>revert</code>ï¼ˆå›é€€ï¼‰å‘½ä»¤ä½¿ç”¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner1(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    if(_owners[tokenId] != msg.sender)&#123;</span><br><span class="line">        revert TransferNotOwner();</span><br><span class="line">    &#125;</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>transferOwner1()</code>å‡½æ•°ï¼Œå®ƒä¼šæ£€æŸ¥ä»£å¸çš„<code>owner</code>æ˜¯ä¸æ˜¯å‘èµ·äººï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šæŠ›å‡º<code>TransferNotOwner</code>å¼‚å¸¸ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œå°±ä¼šè½¬è´¦ã€‚</p>
<p>e.g. è¾“å…¥ä»»æ„<code>uint256</code>æ•°å­—å’Œé0åœ°å€ï¼Œè°ƒç”¨<code>transferOwner1</code>ï¼Œä¹Ÿå°±æ˜¯<code>error</code>æ–¹æ³•ï¼Œæ§åˆ¶å°æŠ›å‡ºäº†å¼‚å¸¸å¹¶æ˜¾ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰çš„<code>TransferNotOwner</code>ã€‚</p>
<h3 id="Require"><a href="#Require" class="headerlink" title="Require"></a>Require</h3><p><code>require</code>å‘½ä»¤æ˜¯<code>solidity 0.8ç‰ˆæœ¬</code>ä¹‹å‰æŠ›å‡ºå¼‚å¸¸çš„å¸¸ç”¨æ–¹æ³•ï¼Œç›®å‰å¾ˆå¤šä¸»æµåˆçº¦ä»ç„¶è¿˜åœ¨ä½¿ç”¨å®ƒã€‚å®ƒå¾ˆå¥½ç”¨ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯<code>gas</code>éšç€æè¿°å¼‚å¸¸çš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ ï¼Œæ¯”<code>error</code>å‘½ä»¤è¦é«˜ã€‚ä½¿ç”¨æ–¹æ³•ï¼š<code>require(æ£€æŸ¥æ¡ä»¶ï¼Œ&quot;å¼‚å¸¸çš„æè¿°&quot;)</code>ï¼Œå½“æ£€æŸ¥æ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>æˆ‘ä»¬ç”¨<code>require</code>å‘½ä»¤é‡å†™ä¸€ä¸‹ä¸Šé¢çš„<code>transferOwner</code>å‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner2(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    require(_owners[tokenId] == msg.sender, &quot;Transfer Not Owner&quot;);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e.g. è¾“å…¥ä»»æ„<code>uint256</code>æ•°å­—å’Œé0åœ°å€ï¼Œè°ƒç”¨<code>transferOwner2</code>ï¼Œä¹Ÿå°±æ˜¯<code>require</code>æ–¹æ³•ï¼Œæ§åˆ¶å°æŠ›å‡ºäº†å¼‚å¸¸å¹¶æ‰“å°å‡º<code>require</code>ä¸­çš„å­—ç¬¦ä¸²ã€‚</p>
<h3 id="Assert"><a href="#Assert" class="headerlink" title="Assert"></a>Assert</h3><p><code>assert</code>å‘½ä»¤ä¸€èˆ¬ç”¨äºç¨‹åºå‘˜å†™ç¨‹åº<code>debug</code>ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£é‡ŠæŠ›å‡ºå¼‚å¸¸çš„åŸå› ï¼ˆæ¯”<code>require</code>å°‘ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚å®ƒçš„ç”¨æ³•å¾ˆç®€å•ï¼Œ<code>assert(æ£€æŸ¥æ¡ä»¶ï¼‰</code>ï¼Œå½“æ£€æŸ¥æ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>æˆ‘ä»¬ç”¨<code>assert</code>å‘½ä»¤é‡å†™ä¸€ä¸‹ä¸Šé¢çš„<code>transferOwner</code>å‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner3(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    assert(_owners[tokenId] == msg.sender);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>e.g. è¾“å…¥ä»»æ„<code>uint256</code>æ•°å­—å’Œé0åœ°å€ï¼Œè°ƒç”¨<code>transferOwner3</code>ï¼Œä¹Ÿå°±æ˜¯<code>assert</code>æ–¹æ³•ï¼Œæ§åˆ¶å°åªæŠ›å‡ºäº†å¼‚å¸¸ã€‚</p>
<h3 id="ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ"><a href="#ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ" class="headerlink" title="ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ"></a>ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ</h3><p>æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸‰ç§æŠ›å‡ºå¼‚å¸¸çš„<code>gas</code>æ¶ˆè€—ï¼Œé€šè¿‡remixæ§åˆ¶å°çš„DebugæŒ‰é’®ï¼Œèƒ½æŸ¥åˆ°æ¯æ¬¡å‡½æ•°è°ƒç”¨çš„<code>gas</code>æ¶ˆè€—åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong><code>error</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—</strong>ï¼š24445</li>
<li><strong><code>require</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—</strong>ï¼š24743</li>
<li><strong><code>assert</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—</strong>ï¼š24446</li>
</ol>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>error</code>æ–¹æ³•<code>gas</code>æœ€å°‘ï¼Œå…¶æ¬¡æ˜¯<code>assert</code>ï¼Œ<code>require</code>æ–¹æ³•æ¶ˆè€—<code>gas</code>æœ€å¤šï¼å› æ­¤ï¼Œ<code>error</code>æ—¢å¯ä»¥å‘ŠçŸ¥ç”¨æˆ·æŠ›å‡ºå¼‚å¸¸çš„åŸå› ï¼Œåˆèƒ½çœ<code>gas</code>ï¼Œå¤§å®¶è¦å¤šç”¨ï¼ï¼ˆæ³¨æ„ï¼Œç”±äºéƒ¨ç½²æµ‹è¯•æ—¶é—´çš„ä¸åŒï¼Œæ¯ä¸ªå‡½æ•°çš„<code>gas</code>æ¶ˆè€—ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯æ¯”è¾ƒç»“æœä¼šæ˜¯ä¸€è‡´çš„ã€‚ï¼‰</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://DestinyWei.github.io">æµ©çƒ¬</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://destinywei.github.io/post/Solidity%E5%85%A5%E9%97%A8.html">https://destinywei.github.io/post/Solidity%E5%85%A5%E9%97%A8.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://DestinyWei.github.io" target="_blank">æµ©çƒ¬çš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Solidity/">Solidity</a></div><div class="post_share"><div class="social-share" data-image="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/solidity%E8%BF%9B%E9%98%B6.html"><img class="prev-cover" src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityè¿›é˜¶.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Solidityå­¦ä¹ ç¬”è®°(äºŒ)</div></div></a></div><div class="next-post pull-right"><a href="/post/Mysql%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE.html"><img class="next-cover" src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Mysql.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Mysqlå®‰è£…ä»¥åŠç¯å¢ƒå˜é‡é…ç½®</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/post/solidity%E8%BF%9B%E9%98%B6.html" title="Solidityå­¦ä¹ ç¬”è®°(äºŒ)"><img class="cover" src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityè¿›é˜¶.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-10</div><div class="title">Solidityå­¦ä¹ ç¬”è®°(äºŒ)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/å¤´åƒ3.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">æµ©çƒ¬</div><div class="author-info__description">åšæŒå°±æ˜¯èƒœåˆ©</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/DestinyWei"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/DestinyWei" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1342348280@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°æˆ‘çš„Blogé¢‘é“ï¼Œè‹¥æœ‰ç–‘é—®ï¼Œè¯·è”ç³»æˆ‘çš„QQï¼š1342348280</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Solidity%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">Solidityå…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-HelloWeb3"><span class="toc-number">1.1.</span> <span class="toc-text">1.HelloWeb3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AASolidity%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.1.1.</span> <span class="toc-text">ç¬¬ä¸€ä¸ªSolidityç¨‹åº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">2.æ•°å€¼ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">å¸ƒå°”å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%BD%A2"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ•´å½¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">åœ°å€ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E9%95%BF%E5%AD%97%E8%8A%82%E6%95%B0%E7%BB%84"><span class="toc-number">1.2.4.</span> <span class="toc-text">å®šé•¿å­—èŠ‚æ•°ç»„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.2.5.</span> <span class="toc-text">æšä¸¾</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%87%BD%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">3.å‡½æ•°ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B0%E5%BA%95%E4%BB%80%E4%B9%88%E6%98%AFPure%E5%92%8CView%EF%BC%9F"><span class="toc-number">1.3.1.</span> <span class="toc-text">åˆ°åº•ä»€ä¹ˆæ˜¯Pureå’ŒViewï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">ä»£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-pure-v-s-view"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">1. pure v.s. view</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-internal-v-s-external"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">2. internal v.s. external</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-payable"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3. payable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA"><span class="toc-number">1.3.3.</span> <span class="toc-text">å‡½æ•°è¾“å‡º</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-return%E5%92%8Creturns"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">è¿”å›å€¼ returnå’Œreturns</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E5%BC%8F%E8%BF%94%E5%9B%9E"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">å‘½åå¼è¿”å›</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84%E5%BC%8F%E8%B5%8B%E5%80%BC"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">è§£æ„å¼èµ‹å€¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">4.å¼•ç”¨ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BD%8D%E7%BD%AE"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ•°æ®ä½ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BD%8D%E7%BD%AE%E5%92%8C%E8%B5%8B%E5%80%BC%E8%A7%84%E5%88%99"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">å˜é‡çš„ä½œç”¨åŸŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%8A%B6%E6%80%81%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.1.2.1.</span> <span class="toc-text">1. çŠ¶æ€å˜é‡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.1.2.2.</span> <span class="toc-text">2. å±€éƒ¨å˜é‡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.1.2.3.</span> <span class="toc-text">3. å…¨å±€å˜é‡</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84-array"><span class="toc-number">1.4.2.</span> <span class="toc-text">æ•°ç»„ array</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E7%BB%84%E7%9A%84%E8%A7%84%E5%88%99"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">åˆ›å»ºæ•°ç»„çš„è§„åˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%88%90%E5%91%98"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">æ•°ç»„æˆå‘˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93-struct"><span class="toc-number">1.4.3.</span> <span class="toc-text">ç»“æ„ä½“ struct</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%98%A0%E5%B0%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.</span> <span class="toc-text">5.æ˜ å°„ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E7%9A%84%E8%A7%84%E5%88%99"><span class="toc-number">1.5.1.</span> <span class="toc-text">æ˜ å°„çš„è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.5.2.</span> <span class="toc-text">æ˜ å°„çš„åŸç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%80%BC"><span class="toc-number">1.6.</span> <span class="toc-text">6.å˜é‡åˆå§‹å€¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%BC%E7%B1%BB%E5%9E%8B%E5%88%9D%E5%A7%8B%E5%80%BC"><span class="toc-number">1.6.1.</span> <span class="toc-text">å€¼ç±»å‹åˆå§‹å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%88%9D%E5%A7%8B%E5%80%BC"><span class="toc-number">1.6.2.</span> <span class="toc-text">å¼•ç”¨ç±»å‹åˆå§‹å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#delete%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">1.6.3.</span> <span class="toc-text">deleteæ“ä½œç¬¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%B8%B8%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">7.å¸¸æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#constant%E5%92%8Cimmutable"><span class="toc-number">1.7.1.</span> <span class="toc-text">constantå’Œimmutable</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#constant"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">constant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#immutable"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">immutable</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%8E%A7%E5%88%B6%E6%B5%81"><span class="toc-number">1.8.</span> <span class="toc-text">8.æ§åˆ¶æµ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8solidity%E5%AE%9E%E7%8E%B0%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="toc-number">1.8.1.</span> <span class="toc-text">ç”¨solidityå®ç°æ’å…¥æ’åº</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%EF%BC%9A90-%E4%BB%A5%E4%B8%8A%E7%9A%84%E4%BA%BA%E7%94%A8solidity%E5%86%99%E6%8F%92%E5%85%A5%E7%AE%97%E6%B3%95%E9%83%BD%E4%BC%9A%E5%87%BA%E9%94%99%E3%80%82"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">å†™åœ¨å‰é¢ï¼š90%ä»¥ä¸Šçš„äººç”¨solidityå†™æ’å…¥ç®—æ³•éƒ½ä¼šå‡ºé”™ã€‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">æ’å…¥æ’åº</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#python%E4%BB%A3%E7%A0%81"><span class="toc-number">1.8.1.2.1.</span> <span class="toc-text">pythonä»£ç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%94%B9%E5%86%99%E6%88%90solidity%E5%90%8E%E6%9C%89BUG%EF%BC%81"><span class="toc-number">1.8.1.2.2.</span> <span class="toc-text">æ”¹å†™æˆsolidityåæœ‰BUGï¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E7%9A%84solidity%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="toc-number">1.8.1.2.3.</span> <span class="toc-text">æ­£ç¡®çš„solidityæ’å…¥æ’åº</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%92%8C%E4%BF%AE%E9%A5%B0%E5%99%A8"><span class="toc-number">1.9.</span> <span class="toc-text">9.æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.1.</span> <span class="toc-text">æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E9%A5%B0%E5%99%A8"><span class="toc-number">1.9.2.</span> <span class="toc-text">ä¿®é¥°å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.10.</span> <span class="toc-text">10.äº‹ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99"><span class="toc-number">1.10.1.</span> <span class="toc-text">è§„åˆ™</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E7%BB%A7%E6%89%BF"><span class="toc-number">1.11.</span> <span class="toc-text">11.ç»§æ‰¿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99-1"><span class="toc-number">1.11.1.</span> <span class="toc-text">è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%BB%A7%E6%89%BF"><span class="toc-number">1.11.2.</span> <span class="toc-text">ç®€å•ç»§æ‰¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF"><span class="toc-number">1.11.3.</span> <span class="toc-text">å¤šé‡ç»§æ‰¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E9%A5%B0%E5%99%A8%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-number">1.11.4.</span> <span class="toc-text">ä¿®é¥°å™¨çš„ç»§æ‰¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-number">1.11.5.</span> <span class="toc-text">æ„é€ å‡½æ•°çš„ç»§æ‰¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E7%88%B6%E5%90%88%E7%BA%A6%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">1.11.6.</span> <span class="toc-text">è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%8A%BD%E8%B1%A1%E5%90%88%E7%BA%A6%E5%92%8C%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.12.</span> <span class="toc-text">12.æŠ½è±¡åˆçº¦å’Œæ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%90%88%E7%BA%A6"><span class="toc-number">1.12.1.</span> <span class="toc-text">æŠ½è±¡åˆçº¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.12.2.</span> <span class="toc-text">æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3%EF%BC%9F"><span class="toc-number">1.12.2.1.</span> <span class="toc-text">ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%BC%82%E5%B8%B8"><span class="toc-number">1.13.</span> <span class="toc-text">13.å¼‚å¸¸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Error"><span class="toc-number">1.13.1.</span> <span class="toc-text">Error</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Require"><span class="toc-number">1.13.2.</span> <span class="toc-text">Require</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Assert"><span class="toc-number">1.13.3.</span> <span class="toc-text">Assert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95%E7%9A%84gas%E6%AF%94%E8%BE%83"><span class="toc-number">1.13.4.</span> <span class="toc-text">ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/BlockChainNote.html" title="åŒ—äº¬å¤§å­¦è‚–è‡»è€å¸ˆã€ŠåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨ã€‹å…¬å¼€è¯¾"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/åŒºå—é“¾.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="åŒ—äº¬å¤§å­¦è‚–è‡»è€å¸ˆã€ŠåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨ã€‹å…¬å¼€è¯¾"/></a><div class="content"><a class="title" href="/post/BlockChainNote.html" title="åŒ—äº¬å¤§å­¦è‚–è‡»è€å¸ˆã€ŠåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨ã€‹å…¬å¼€è¯¾">åŒ—äº¬å¤§å­¦è‚–è‡»è€å¸ˆã€ŠåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨ã€‹å…¬å¼€è¯¾</a><time datetime="2023-04-10T11:17:41.356Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB%E7%A0%B4%E8%A7%A3.html" title="æœ‰é“ç¿»è¯‘ç®€å•çˆ¬è™«ç ´è§£"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/blog-picture.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æœ‰é“ç¿»è¯‘ç®€å•çˆ¬è™«ç ´è§£"/></a><div class="content"><a class="title" href="/post/%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB%E7%A0%B4%E8%A7%A3.html" title="æœ‰é“ç¿»è¯‘ç®€å•çˆ¬è™«ç ´è§£">æœ‰é“ç¿»è¯‘ç®€å•çˆ¬è™«ç ´è§£</a><time datetime="2023-04-10T11:17:41.354Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/solidity%E8%BF%9B%E9%98%B6.html" title="Solidityå­¦ä¹ ç¬”è®°(äºŒ)"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityè¿›é˜¶.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Solidityå­¦ä¹ ç¬”è®°(äºŒ)"/></a><div class="content"><a class="title" href="/post/solidity%E8%BF%9B%E9%98%B6.html" title="Solidityå­¦ä¹ ç¬”è®°(äºŒ)">Solidityå­¦ä¹ ç¬”è®°(äºŒ)</a><time datetime="2023-04-10T11:17:41.354Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Solidity%E5%85%A5%E9%97%A8.html" title="Solidityå­¦ä¹ ç¬”è®°(ä¸€)"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Solidityå­¦ä¹ ç¬”è®°(ä¸€)"/></a><div class="content"><a class="title" href="/post/Solidity%E5%85%A5%E9%97%A8.html" title="Solidityå­¦ä¹ ç¬”è®°(ä¸€)">Solidityå­¦ä¹ ç¬”è®°(ä¸€)</a><time datetime="2023-04-10T11:17:41.353Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Mysql%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE.html" title="Mysqlå®‰è£…ä»¥åŠç¯å¢ƒå˜é‡é…ç½®"><img src="https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mysqlå®‰è£…ä»¥åŠç¯å¢ƒå˜é‡é…ç½®"/></a><div class="content"><a class="title" href="/post/Mysql%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE.html" title="Mysqlå®‰è£…ä»¥åŠç¯å¢ƒå˜é‡é…ç½®">Mysqlå®‰è£…ä»¥åŠç¯å¢ƒå˜é‡é…ç½®</a><time datetime="2023-04-10T11:17:41.352Z" title="å‘è¡¨äº 2023-04-10 19:17:41">2023-04-10</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://weihaoming-tuchuang.oss-cn-chengdu.aliyuncs.com/img/Solidityå…¥é—¨.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 <i id="heartbeat" class="fa fas fa-heartbeat"></i>  æµ©çƒ¬</div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>! <div> <a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral">æœ¬ç½‘ç«™ç”± <img src="img/åˆæ‹äº‘_logo2.png" width="30px" height="15px" /> æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a> </div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>